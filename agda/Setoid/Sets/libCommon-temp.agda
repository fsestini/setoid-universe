{-# OPTIONS --rewriting --without-K --prop #-}

module Setoid.Sets.libCommon-temp where

open import Setoid.lib
-- should work with either of the following two libraries:
-- open import Setoid.Sets.lib public
open import Setoid.SetsII.lib public

module simple-just-U
  {i}
  (in-U·¥∞ : ‚àÄ{A : Set} ‚Üí in-U A ‚Üí Set i)
  (bool·¥∞ : in-U·¥∞ bool)
  (œÄ·¥∞ : {A : Set}{a : in-U A}(a·¥∞ : in-U·¥∞ a){A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}
    {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}(b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
    ‚Üí in-U·¥∞ (œÄ a a~ b b~))
  where
  ind-in-U : ‚àÄ{A : Set}(a : in-U A) ‚Üí in-U·¥∞ a
  ind-in-U = simple.ind-in-U in-U·¥∞ (Œª _ ‚Üí ‚ä§) bool·¥∞ (Œª a·¥∞ {A~}{a~} _ b·¥∞ {B~}{b~} _ ‚Üí œÄ·¥∞ a·¥∞ {A~}{a~} b·¥∞ {B~}{b~}) tt (Œª _ _ _ _ _ _ _ _ _ _ ‚Üí tt)

module simpleProp-just-U
  {i}
  (in-U·¥∞ : ‚àÄ{A : Set} ‚Üí in-U A ‚Üí Prop i)
  (bool·¥∞ : in-U·¥∞ bool)
  (œÄ·¥∞ : {A : Set}{a : in-U A}(a·¥∞ : in-U·¥∞ a){A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}
    {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}(b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
    ‚Üí in-U·¥∞ (œÄ a a~ b b~))
  where

  ind-in-U : ‚àÄ{A : Set}(a : in-U A) ‚Üí in-U·¥∞ a
  ind-in-U = simpleProp.ind-in-U in-U·¥∞ (Œª _ ‚Üí ‚ä§p) bool·¥∞
    (Œª {A}{a} a·¥∞ {A~}{a~} _ {B}{b} b·¥∞ {B~}{b~} _ ‚Üí œÄ·¥∞ {A}{a} a·¥∞ {A~}{a~}{B}{b} b·¥∞ {B~}{b~})
    ttp (Œª _ _ _ _ _ _ _ _ _ _ ‚Üí ttp)

module simple-just-U~
  {j}
  (in-U~·¥∞ : {A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí Set j)
  (bool~·¥∞ : in-U~·¥∞ {a‚ÇÄ = bool}{a‚ÇÅ = bool} bool~)
  (œÄ~·¥∞ :
    {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}(a‚ÇÄ~·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÄ} a‚ÇÄ~)
    {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}(a‚ÇÅ~·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÅ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÄ‚ÇÅ)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}(b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÄ x‚ÇÄ}{a‚ÇÅ = b‚ÇÄ x‚ÇÅ} (b‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}(b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÅ x‚ÇÄ}{a‚ÇÅ = b‚ÇÅ x‚ÇÅ} (b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÄ x‚ÇÄ}{a‚ÇÅ = b‚ÇÅ x‚ÇÅ} (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U~·¥∞ {a‚ÇÄ = œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~}{a‚ÇÅ = œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~} (œÄ~ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ = a‚ÇÅ}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ}{b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ = b‚ÇÅ}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ))
  where
  ind-in-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÄ‚ÇÅ
  ind-in-U~ a‚ÇÄ‚ÇÅ = simple.ind-in-U~
    (Œª _ ‚Üí ‚ä§)
    (Œª {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A‚ÇÄ‚ÇÅ} ‚Üí in-U~·¥∞ {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A‚ÇÄ‚ÇÅ})
    tt
    (Œª _ _ _ _ ‚Üí tt)
    bool~·¥∞
    (Œª _ a‚ÇÄ~·¥∞ _ a‚ÇÅ~·¥∞ a‚ÇÄ‚ÇÅ·¥∞ _ b‚ÇÄ~·¥∞ _ b‚ÇÅ~·¥∞ b‚ÇÄ‚ÇÅ·¥∞ ‚Üí œÄ~·¥∞ a‚ÇÄ~·¥∞ a‚ÇÅ~·¥∞ a‚ÇÄ‚ÇÅ·¥∞ b‚ÇÄ~·¥∞ b‚ÇÅ~·¥∞ b‚ÇÄ‚ÇÅ·¥∞)
    a‚ÇÄ‚ÇÅ

module simpleProp-just-U~
  {j}
  (in-U~·¥∞ : {A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí Prop j)
  (bool~·¥∞ : in-U~·¥∞ {a‚ÇÄ = bool}{a‚ÇÅ = bool} bool~)
  (œÄ~·¥∞ :
    {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}(a‚ÇÄ~·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÄ} a‚ÇÄ~)
    {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}(a‚ÇÅ~·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÅ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÄ‚ÇÅ)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}(b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÄ x‚ÇÄ}{a‚ÇÅ = b‚ÇÄ x‚ÇÅ} (b‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}(b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÅ x‚ÇÄ}{a‚ÇÅ = b‚ÇÅ x‚ÇÅ} (b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÄ x‚ÇÄ}{a‚ÇÅ = b‚ÇÅ x‚ÇÅ} (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U~·¥∞ {a‚ÇÄ = œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~}{a‚ÇÅ = œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~} (œÄ~ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ = a‚ÇÅ}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ}{b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ = b‚ÇÅ}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ))
  where
  ind-in-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÄ‚ÇÅ
  ind-in-U~ a‚ÇÄ‚ÇÅ = simpleProp.ind-in-U~
    (Œª _ ‚Üí ‚ä§p)
    (Œª {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A‚ÇÄ‚ÇÅ} ‚Üí in-U~·¥∞ {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A‚ÇÄ‚ÇÅ})
    ttp
    (Œª _ _ _ _ ‚Üí ttp)
    bool~·¥∞
    (Œª _ a‚ÇÄ~·¥∞ _ a‚ÇÅ~·¥∞ a‚ÇÄ‚ÇÅ·¥∞ _ b‚ÇÄ~·¥∞ _ b‚ÇÅ~·¥∞ b‚ÇÄ‚ÇÅ·¥∞ ‚Üí œÄ~·¥∞ a‚ÇÄ~·¥∞ a‚ÇÅ~·¥∞ a‚ÇÄ‚ÇÅ·¥∞ b‚ÇÄ~·¥∞ b‚ÇÅ~·¥∞ b‚ÇÄ‚ÇÅ·¥∞)
    a‚ÇÄ‚ÇÅ

module double
  {i}
  (in-U·¥∞ : ‚àÄ{A‚Å∞} ‚Üí in-U A‚Å∞ ‚Üí ‚àÄ{A¬π} ‚Üí in-U A¬π ‚Üí Set i)
  (boolbool·¥∞ : in-U·¥∞ bool bool)
  (boolœÄ·¥∞ : {A : Set}(a : in-U A){A~ : A ‚Üí A ‚Üí Prop}(a~ : in-U~ a a A~)
    {B : A ‚Üí Set}(b : (x : A) ‚Üí in-U (B x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)) ‚Üí  in-U·¥∞ bool (œÄ a a~ b b~))
  (œÄbool·¥∞ : {A : Set}(a : in-U A){A~ : A ‚Üí A ‚Üí Prop}(a~ : in-U~ a a A~)
    {B : A ‚Üí Set}(b : (x : A) ‚Üí in-U (B x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)) ‚Üí  in-U·¥∞ (œÄ a a~ b b~) bool)
  (œÄœÄ·¥∞ : {A‚Å∞ : Set}{A¬π : Set}{a‚Å∞ : in-U A‚Å∞}{a¬π : in-U A¬π}(a·¥∞ : in-U·¥∞ a‚Å∞ a¬π)
    {A~‚Å∞ : A‚Å∞ ‚Üí A‚Å∞ ‚Üí Prop}{A~¬π : A¬π ‚Üí A¬π ‚Üí Prop}(a~‚Å∞ : in-U~ a‚Å∞ a‚Å∞ A~‚Å∞)(a~¬π : in-U~ a¬π a¬π A~¬π)
    {B‚Å∞ : A‚Å∞ ‚Üí Set}{B¬π : A¬π ‚Üí Set}{b‚Å∞ : (x : A‚Å∞) ‚Üí in-U (B‚Å∞ x)}{b¬π : (x : A¬π) ‚Üí in-U (B¬π x)}(b·¥∞ : (x‚Å∞ : A‚Å∞)(x¬π : A¬π) ‚Üí in-U·¥∞ (b‚Å∞ x‚Å∞) (b¬π x¬π))
    {B~‚Å∞ : {x‚ÇÄ x‚ÇÅ : A‚Å∞}(x‚ÇÄ‚ÇÅ : A~‚Å∞ x‚ÇÄ x‚ÇÅ) ‚Üí B‚Å∞ x‚ÇÄ ‚Üí B‚Å∞ x‚ÇÅ ‚Üí Prop}{B~¬π : {x‚ÇÄ x‚ÇÅ : A¬π}(x‚ÇÄ‚ÇÅ : A~¬π x‚ÇÄ x‚ÇÅ) ‚Üí B¬π x‚ÇÄ ‚Üí B¬π x‚ÇÅ ‚Üí Prop}
    (b~‚Å∞ : {x‚ÇÄ x‚ÇÅ : A‚Å∞}(x‚ÇÄ‚ÇÅ : A~‚Å∞ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚Å∞ x‚ÇÄ) (b‚Å∞ x‚ÇÅ) (B~‚Å∞ x‚ÇÄ‚ÇÅ))(b~¬π : {x‚ÇÄ x‚ÇÅ : A¬π}(x‚ÇÄ‚ÇÅ : A~¬π x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b¬π x‚ÇÄ) (b¬π x‚ÇÅ) (B~¬π x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U·¥∞ (œÄ a‚Å∞ a~‚Å∞ b‚Å∞ b~‚Å∞) (œÄ a¬π a~¬π b¬π b~¬π))
  where
  ind-in-U : ‚àÄ{A‚Å∞ : Set}(a‚Å∞ : in-U A‚Å∞){A¬π : Set}(a¬π : in-U A¬π) ‚Üí in-U·¥∞ a‚Å∞ a¬π
  ind-in-U = simple.ind-in-U (Œª a‚Å∞ ‚Üí ‚àÄ{A¬π}(a¬π : in-U A¬π) ‚Üí in-U·¥∞ a‚Å∞ a¬π) (Œª _ ‚Üí ‚ä§)
    (simple.ind-in-U (Œª a¬π ‚Üí in-U·¥∞ bool a¬π) (Œª _ ‚Üí ‚ä§) boolbool·¥∞ (Œª {A}{a} _ {A~}{a~} _ {B}{b} _ {B~}{b~} _ ‚Üí boolœÄ·¥∞ a a~ b b~) tt (Œª _ _ _ _ _ _ _ _ _ _ ‚Üí tt))
    (Œª {A‚Å∞}{a‚Å∞} a·¥∞' {A~‚Å∞}{a~‚Å∞} _ {B‚Å∞}{b‚Å∞} b·¥∞' {B~‚Å∞}{b~‚Å∞} _ ‚Üí simple.ind-in-U
      (Œª c¬π ‚Üí in-U·¥∞ (œÄ a‚Å∞ a~‚Å∞ b‚Å∞ b~‚Å∞) c¬π) (Œª _ ‚Üí ‚ä§)
      (œÄbool·¥∞ a‚Å∞ a~‚Å∞ b‚Å∞ b~‚Å∞)
      (Œª {A¬π}{a¬π} a·¥∞ {A~¬π}{a~¬π} _ {B¬π}{b¬π} b·¥∞ {B~¬π}{b~¬π} _ ‚Üí œÄœÄ·¥∞ {a‚Å∞ = a‚Å∞}{a¬π} (a·¥∞' a¬π) a~‚Å∞ a~¬π {b‚Å∞ = b‚Å∞}{b¬π} (Œª x‚Å∞ x¬π ‚Üí b·¥∞' x‚Å∞ (b¬π x¬π)) b~‚Å∞ b~¬π)
      tt Œª _ _ _ _ _ _ _ _ _ _ ‚Üí tt)
    tt (Œª _ _ _ _ _ _ _ _ _ _ ‚Üí tt)

open import Agda.Builtin.Equality

postulate
  _‚â°p_ : ‚àÄ{i} {A : Set i} -> A -> A -> Prop i
  reflp : ‚àÄ{i} {A : Set i} {a : A} -> a ‚â°p a
  transp-‚â°p : ‚àÄ{i j}{A : Set i} {x y : A} (P : A ‚Üí Set j) ‚Üí x ‚â°p y ‚Üí P x ‚Üí P y
  transp-‚â°p-refl : ‚àÄ{i j}{A : Set i} {x y : A} (P : A ‚Üí Set j) ‚Üí (d : P x) ‚Üí transp-‚â°p P reflp d ‚â° d

{-# BUILTIN REWRITE _‚â°_ #-}
{-# REWRITE transp-‚â°p-refl #-}

ap : ‚àÄ{i j}{A : Set i}{B : Set j} {x y : A} (f : A ‚Üí B) ‚Üí (p : x ‚â° y) ‚Üí f x ‚â° f y
ap f refl = refl
transp : ‚àÄ{i j}{A : Set i} {x y : A} (P : A ‚Üí Set j) ‚Üí x ‚â° y ‚Üí P x ‚Üí P y
transp _ refl a = a
transpp : ‚àÄ{i j}{A : Set i} {x y : A} (P : A ‚Üí Prop j) ‚Üí x ‚â° y ‚Üí P x ‚Üí P y
transpp _ refl a = a
_‚Åª¬π : ‚àÄ{i}{A : Set i}{x y : A} ‚Üí x ‚â° y ‚Üí y ‚â° x
refl ‚Åª¬π = refl

to-‚â° : ‚àÄ{i} {A : Set i} {x y : A} -> x ‚â°p y -> x ‚â° y
to-‚â° e = transp-‚â°p (Œª y ‚Üí _ ‚â° y) e refl

trans : ‚àÄ{i} {A : Set i} {x y z : A} ‚Üí x ‚â° y ‚Üí y ‚â° z ‚Üí x ‚â° z
trans refl p = p

projŒ£‚â°‚ÇÅ : ‚àÄ{i j}{A : Set i}{B : A ‚Üí Set j}{a‚ÇÄ a‚ÇÅ : A}{b‚ÇÄ : B a‚ÇÄ}{b‚ÇÅ : B a‚ÇÅ} ‚Üí (a‚ÇÄ ,Œ£ b‚ÇÄ) ‚â° (a‚ÇÅ ,Œ£ b‚ÇÅ) ‚Üí a‚ÇÄ ‚â° a‚ÇÅ
projŒ£‚â°‚ÇÅ refl = refl

noconf : {A : Set}{a : in-U A}{A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}{B : A ‚Üí Set}
  {b : (x : A) ‚Üí in-U (B x)}{B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}{b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)} ‚Üí 
  _‚â°_ {A = Œ£ _ in-U} (_ ,Œ£ œÄ a a~ b b~) (_ ,Œ£ bool) ‚Üí ‚ä•
noconf e = transp (Œª X ‚Üí X) (ap (Œª w ‚Üí simple-just-U.ind-in-U (Œª _ ‚Üí Set) ‚ä• (Œª _ _ ‚Üí ‚ä§) (proj‚ÇÇ w)) e) tt

no-bool-œÄ :
  {A : Set}{a : in-U A}{A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}
  {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}{B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}{b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
  {C‚ÇÄ‚ÇÅ : _} ‚Üí
  in-U~ bool (œÄ a a~ b b~) C‚ÇÄ‚ÇÅ ‚Üí ‚ä•
no-bool-œÄ {A}{a}{A~}{a~}{B}{b}{B~}{b~}{C‚ÇÄ‚ÇÅ} c‚ÇÄ‚ÇÅ = simple-just-U~.ind-in-U~
  (Œª {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A‚ÇÄ‚ÇÅ} a‚ÇÄ‚ÇÅ ‚Üí (e‚ÇÄ : _‚â°_ {A = Œ£ _ in-U} (_ ,Œ£ a‚ÇÄ) (_ ,Œ£ bool))(e‚ÇÅ : _‚â°_ {A = Œ£ _ in-U} (_ ,Œ£ a‚ÇÅ) (_ ,Œ£ œÄ a a~ b b~)) ‚Üí ‚ä•)
  (Œª _ e ‚Üí noconf {a = a}{a~ = a~}{b = b}{b~ = b~} (e ‚Åª¬π))
  (Œª {_}{a‚ÇÄ}{_}{a‚ÇÄ~} _ _ _ {_}{b‚ÇÄ}{_}{b‚ÇÄ~} _ _ _ e _ ‚Üí noconf {a = a‚ÇÄ}{a~ = a‚ÇÄ~}{b = b‚ÇÄ}{b~ = b‚ÇÄ~} e)
  c‚ÇÄ‚ÇÅ
  refl
  refl

no-œÄ-bool :
  {A : Set}{a : in-U A}{A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}
  {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}{B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}{b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
  {C‚ÇÄ‚ÇÅ : _} ‚Üí
  in-U~ (œÄ a a~ b b~) bool C‚ÇÄ‚ÇÅ ‚Üí ‚ä•
no-œÄ-bool {A}{a}{A~}{a~}{B}{b}{B~}{b~}{C‚ÇÄ‚ÇÅ} c‚ÇÄ‚ÇÅ = simple-just-U~.ind-in-U~
  (Œª {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A‚ÇÄ‚ÇÅ} a‚ÇÄ‚ÇÅ ‚Üí (e‚ÇÄ : _‚â°_ {A = Œ£ _ in-U} (_ ,Œ£ a‚ÇÄ) (_ ,Œ£ œÄ a a~ b b~))(e‚ÇÅ : _‚â°_ {A = Œ£ _ in-U} (_ ,Œ£ a‚ÇÅ) (_ ,Œ£ bool)) ‚Üí ‚ä•)
  (Œª e _ ‚Üí noconf {a = a}{a~ = a~}{b = b}{b~ = b~} (e ‚Åª¬π))
  (Œª _ {_}{a‚ÇÅ}{_}{a‚ÇÅ~} _ _ _ {_}{b‚ÇÅ}{_}{b‚ÇÅ~} _ _ _ e ‚Üí noconf {a = a‚ÇÅ}{a~ = a‚ÇÅ~}{b = b‚ÇÅ}{b~ = b‚ÇÅ~} e)
  c‚ÇÄ‚ÇÅ
  refl
  refl

projbool~p : ‚àÄ{i}(P : ‚àÄ{C‚ÇÄ‚ÇÅ} ‚Üí in-U~ bool bool C‚ÇÄ‚ÇÅ ‚Üí Prop i) ‚Üí P bool~ ‚Üí ‚àÄ{C‚ÇÄ‚ÇÅ}(c‚ÇÄ‚ÇÅ : in-U~ bool bool C‚ÇÄ‚ÇÅ) ‚Üí P c‚ÇÄ‚ÇÅ
projbool~p P p {C‚ÇÄ‚ÇÅ} c‚ÇÄ‚ÇÅ = simpleProp-just-U~.ind-in-U~
  (Œª {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A‚ÇÄ‚ÇÅ} a‚ÇÄ‚ÇÅ ‚Üí (e‚ÇÄ : (_ ,Œ£ a‚ÇÄ) ‚â° (_ ,Œ£ bool))(e‚ÇÅ : (_ ,Œ£ a‚ÇÅ) ‚â° (_ ,Œ£ bool)) ‚Üí P (f e‚ÇÄ e‚ÇÅ a‚ÇÄ‚ÇÅ))
  (Œª { refl refl ‚Üí p })
  (Œª _ {_}{a‚ÇÅ}{_}{a‚ÇÅ~} _ _ _ {_}{b‚ÇÅ}{_}{b‚ÇÅ~} _ _ _ w ‚Üí ‚ä•elimp (noconf {a = a‚ÇÅ}{a~ = a‚ÇÅ~}{b = b‚ÇÅ}{b~ = b‚ÇÅ~} w))
  c‚ÇÄ‚ÇÅ refl refl
  where
  f' : ‚àÄ{A‚ÇÄ}{A‚ÇÅ}(e‚ÇÄ : A‚ÇÄ ‚â° ùüö)(e‚ÇÅ : A‚ÇÅ ‚â° ùüö)(A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop) ‚Üí (ùüö ‚Üí ùüö ‚Üí Prop)
  f' refl refl A‚ÇÄ‚ÇÅ = A‚ÇÄ‚ÇÅ
  f : ‚àÄ{A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(e‚ÇÄ : (A‚ÇÄ ,Œ£ a‚ÇÄ) ‚â° (ùüö ,Œ£ bool))(e‚ÇÅ : (A‚ÇÅ ,Œ£ a‚ÇÅ) ‚â° (ùüö ,Œ£ bool)) ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí in-U~ bool bool (f' (projŒ£‚â°‚ÇÅ e‚ÇÄ) (projŒ£‚â°‚ÇÅ e‚ÇÅ) A‚ÇÄ‚ÇÅ)
  f refl refl a‚ÇÄ‚ÇÅ = a‚ÇÄ‚ÇÅ

{-
{-
data F : Set ‚Üí Set‚ÇÅ where
  bb : (A B : Set) ‚Üí F (A ‚Üí B)
fff : {X Y : Set} ‚Üí  _‚â°_ {A = Œ£ Set F} ((X ‚Üí ùüö) ,Œ£ bb X ùüö) ((Y ‚Üí ùüö) ,Œ£ bb Y ùüö) ‚Üí Set
fff {X} refl = {!!}
-}

f' : ‚àÄ{A‚ÇÄ}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}{B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}{B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
  {C‚ÇÄ}{C‚ÇÅ}
  (e‚ÇÄ : C‚ÇÄ ‚â° (Œ£sp ((x : A‚ÇÄ) ‚Üí B‚ÇÄ x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A‚ÇÄ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÄ~ (un‚Üëps x‚ÇÄ‚ÇÅ) (f x‚ÇÄ) (f x‚ÇÅ))))
  (e‚ÇÅ : C‚ÇÅ ‚â° (Œ£sp ((x : A‚ÇÅ) ‚Üí B‚ÇÅ x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÅ~ (un‚Üëps x‚ÇÄ‚ÇÅ) (f x‚ÇÄ) (f x‚ÇÅ))))
  (C‚ÇÄ‚ÇÅ : C‚ÇÄ ‚Üí C‚ÇÅ ‚Üí Prop) ‚Üí ((Œ£sp ((x : A‚ÇÄ) ‚Üí B‚ÇÄ x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A‚ÇÄ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÄ~ (un‚Üëps x‚ÇÄ‚ÇÅ) (f x‚ÇÄ) (f x‚ÇÅ))) ‚Üí (Œ£sp ((x : A‚ÇÅ) ‚Üí B‚ÇÅ x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÅ~ (un‚Üëps x‚ÇÄ‚ÇÅ) (f x‚ÇÄ) (f x‚ÇÅ))) ‚Üí Prop)
f' refl refl C‚ÇÄ‚ÇÅ = C‚ÇÄ‚ÇÅ  
f : ‚àÄ{A‚ÇÄ}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}{B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}{B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
  {C‚ÇÄ}{C‚ÇÅ}{c‚ÇÄ : in-U C‚ÇÄ}{c‚ÇÅ : in-U C‚ÇÅ}{C‚ÇÄ‚ÇÅ : C‚ÇÄ ‚Üí C‚ÇÅ ‚Üí Prop}
  (e‚ÇÄ : _‚â°_ {A = Œ£ Set in-U} (C‚ÇÄ ,Œ£ c‚ÇÄ) (_ ,Œ£ œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~))
  (e‚ÇÅ : _‚â°_ {A = Œ£ Set in-U} (C‚ÇÅ ,Œ£ c‚ÇÅ) (_ ,Œ£ œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~)) ‚Üí
  in-U~ c‚ÇÄ c‚ÇÅ C‚ÇÄ‚ÇÅ ‚Üí in-U~ (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~) (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~) (f' {a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ~ = a‚ÇÅ~}{b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ~ = b‚ÇÅ~}(projŒ£‚â°‚ÇÅ e‚ÇÄ)(projŒ£‚â°‚ÇÅ e‚ÇÅ) C‚ÇÄ‚ÇÅ)
f refl refl c‚ÇÄ‚ÇÅ = c‚ÇÄ‚ÇÅ

projœÄ~ : ‚àÄ{i} ‚Üí
  (P : ‚àÄ{A‚ÇÄ}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}{B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}{B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}{C‚ÇÄ‚ÇÅ} ‚Üí
    in-U~ (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~) (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~) C‚ÇÄ‚ÇÅ ‚Üí Set i) ‚Üí 
  (‚àÄ{A‚ÇÄ}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}{B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}{B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}{B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)} ‚Üí 
    P {a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ~ = a‚ÇÅ~}{b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ~ = b‚ÇÅ~} (œÄ~ a‚ÇÄ‚ÇÅ b‚ÇÄ‚ÇÅ)) ‚Üí
  ‚àÄ{A‚ÇÄ}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}{B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}{B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
  {C‚ÇÄ‚ÇÅ}(c‚ÇÄ‚ÇÅ : in-U~ (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~) (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~) C‚ÇÄ‚ÇÅ) ‚Üí P c‚ÇÄ‚ÇÅ
projœÄ~ P p {A‚ÇÄ}{a‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~}{B‚ÇÄ}{b‚ÇÄ}{B‚ÇÄ~}{b‚ÇÄ~}{B‚ÇÅ}{b‚ÇÅ}{B‚ÇÅ~}{b‚ÇÅ~}{C‚ÇÄ‚ÇÅ} c‚ÇÄ‚ÇÅ = simple-just-U~.ind-in-U~
  (Œª {C‚ÇÄ}{C‚ÇÅ}{c‚ÇÄ}{c‚ÇÅ}{C‚ÇÄ‚ÇÅ} c‚ÇÄ‚ÇÅ ‚Üí ‚àÄ{A‚ÇÄ}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}{B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}{B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}{b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}(e‚ÇÄ : (_ ,Œ£ c‚ÇÄ) ‚â° (_ ,Œ£ œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~))(e‚ÇÅ : (_ ,Œ£ c‚ÇÅ) ‚â° (_ ,Œ£ œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~)) ‚Üí P (f e‚ÇÄ e‚ÇÅ c‚ÇÄ‚ÇÅ))
  (Œª e ‚Üí ‚ä•elim (noconf (e ‚Åª¬π)))
  (Œª {A‚ÇÄ}{a‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~} a‚ÇÄ~·¥∞ {A‚ÇÅ}{a‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~} a‚ÇÅ~·¥∞ {A‚ÇÄ‚ÇÅ}{a‚ÇÄ‚ÇÅ} a‚ÇÄ‚ÇÅ·¥∞ {B‚ÇÄ}{b‚ÇÄ}{B‚ÇÄ~}{b‚ÇÄ~} b‚ÇÄ~·¥∞ {B‚ÇÅ}{b‚ÇÅ}{B‚ÇÅ~}{b‚ÇÅ~} b‚ÇÅ~·¥∞ {B‚ÇÄ‚ÇÅ}{b‚ÇÄ‚ÇÅ} b‚ÇÄ‚ÇÅ·¥∞ ‚Üí {!p!})
  c‚ÇÄ‚ÇÅ {A‚ÇÄ}{a‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~}{B‚ÇÄ}{b‚ÇÄ}{B‚ÇÄ~}{b‚ÇÄ~}{B‚ÇÅ}{b‚ÇÅ}{B‚ÇÅ~}{b‚ÇÅ~} refl refl
-}
open import Data.Sum

record œÄ-data : Set‚ÇÅ where
  field
    A : Set
    A~ : A ‚Üí A ‚Üí Prop
    B : A ‚Üí Set
    B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop
    a : in-U A
    a~ : in-U~ a a A~
    b : (x : _) ‚Üí in-U (B x)
    b~ : {x‚ÇÄ : A} {x‚ÇÅ : A} (x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)
open œÄ-data

get-œÄ-data : {A : _} ‚Üí in-U A ‚Üí ‚ä§ ‚äé œÄ-data
get-œÄ-data = simple-just-U.ind-in-U (Œª x ‚Üí ‚ä§ ‚äé œÄ-data) (inj‚ÇÅ tt) Œª {_} {a} _ {_} {a~} {_} {b} _ {_} {b~} ‚Üí
  inj‚ÇÇ (record { A = _ ; A~ = _ ; B = _ ; B~ = _ ; a = a ; a~ = a~ ; b = b ; b~ = b~ })

‚ä§' : Set‚ÇÅ
‚ä§' = {A : Set} ‚Üí A ‚Üí A

pj-œÄ~-ty : ‚ä§ ‚äé œÄ-data ‚Üí ‚ä§ ‚äé œÄ-data ‚Üí Set‚ÇÅ
pj-œÄ~-ty (inj‚ÇÅ x) y = ‚ä§'
pj-œÄ~-ty (inj‚ÇÇ x) (inj‚ÇÅ x‚ÇÅ) = ‚ä§'
pj-œÄ~-ty (inj‚ÇÇ record { A = A‚ÇÄ ; A~ = A‚ÇÄ~ ; B = B‚ÇÄ ; B~ = B‚ÇÄ~ ; a = a‚ÇÄ ; b = b‚ÇÄ })
         (inj‚ÇÇ record { A = A‚ÇÅ ; A~ = A‚ÇÅ~ ; B = B‚ÇÅ ; B~ = B‚ÇÅ~ ; a = a‚ÇÅ ; b = b‚ÇÅ }) =
         Œ£ (A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop) Œª A~ ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A~ √ó Œ£ ({x‚ÇÄ : A‚ÇÄ} {x‚ÇÅ : A‚ÇÅ} ‚Üí A~ x‚ÇÄ x‚ÇÅ ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop)
           (Œª B~ ‚Üí ({x‚ÇÄ : A‚ÇÄ} {x‚ÇÅ : A‚ÇÅ} (x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)))

pj-œÄ~ : {A‚ÇÄ A‚ÇÅ : _} {a‚ÇÄ : in-U A‚ÇÄ} {a‚ÇÅ : in-U A‚ÇÅ} {A~ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}
      ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A~ ‚Üí pj-œÄ~-ty (get-œÄ-data a‚ÇÄ) (get-œÄ-data a‚ÇÅ)
pj-œÄ~ {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A~} = simple.ind-in-U~ (Œª _ ‚Üí ‚ä§) (Œª {_} {_} {a‚ÇÄ} {a‚ÇÅ} _ ‚Üí pj-œÄ~-ty (get-œÄ-data a‚ÇÄ) (get-œÄ-data a‚ÇÅ))
  tt (Œª _ _ _ _ ‚Üí tt) (Œª z ‚Üí z) (Œª {a‚ÇÄ·¥∞ a‚ÇÄ~·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~·¥∞ {a‚ÇÄ‚ÇÅ = a‚ÇÄ‚ÇÅ} a‚ÇÄ‚ÇÅ·¥∞ b‚ÇÄ·¥∞ b‚ÇÄ~·¥∞ b‚ÇÅ·¥∞ b‚ÇÅ~·¥∞ {b‚ÇÄ‚ÇÅ = b‚ÇÄ‚ÇÅ} b‚ÇÄ‚ÇÅ·¥∞ ‚Üí _ ,Œ£ (a‚ÇÄ‚ÇÅ ,Œ£ (_ ,Œ£ b‚ÇÄ‚ÇÅ))}) {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A~} 

projœÄ~‚ÇÅ' : -- TODO: derive this from pj-œÄ~
  {A‚Å∞ : Set}{A¬π : Set}{a‚Å∞ : in-U A‚Å∞}{a¬π : in-U A¬π}
  {A~‚Å∞ : A‚Å∞ ‚Üí A‚Å∞ ‚Üí Prop}{A~¬π : A¬π ‚Üí A¬π ‚Üí Prop}{a~‚Å∞ : in-U~ a‚Å∞ a‚Å∞ A~‚Å∞}{a~¬π : in-U~ a¬π a¬π A~¬π}
  {B‚Å∞ : A‚Å∞ ‚Üí Set}{B¬π : A¬π ‚Üí Set}{b‚Å∞ : (x : A‚Å∞) ‚Üí in-U (B‚Å∞ x)}{b¬π : (x : A¬π) ‚Üí in-U (B¬π x)}
  {B~‚Å∞ : {x‚ÇÄ x‚ÇÅ : A‚Å∞}(x‚ÇÄ‚ÇÅ : A~‚Å∞ x‚ÇÄ x‚ÇÅ) ‚Üí B‚Å∞ x‚ÇÄ ‚Üí B‚Å∞ x‚ÇÅ ‚Üí Prop}{B~¬π : {x‚ÇÄ x‚ÇÅ : A¬π}(x‚ÇÄ‚ÇÅ : A~¬π x‚ÇÄ x‚ÇÅ) ‚Üí B¬π x‚ÇÄ ‚Üí B¬π x‚ÇÅ ‚Üí Prop}
  {b~‚Å∞ : {x‚ÇÄ x‚ÇÅ : A‚Å∞}(x‚ÇÄ‚ÇÅ : A~‚Å∞ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚Å∞ x‚ÇÄ) (b‚Å∞ x‚ÇÅ) (B~‚Å∞ x‚ÇÄ‚ÇÅ)}{b~¬π : {x‚ÇÄ x‚ÇÅ : A¬π}(x‚ÇÄ‚ÇÅ : A~¬π x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b¬π x‚ÇÄ) (b¬π x‚ÇÅ) (B~¬π x‚ÇÄ‚ÇÅ)} ‚Üí
  ‚àÄ{C‚ÇÄ‚ÇÅ} ‚Üí in-U~ (œÄ a‚Å∞ a~‚Å∞ b‚Å∞ b~‚Å∞) (œÄ a¬π a~¬π b¬π b~¬π) C‚ÇÄ‚ÇÅ ‚Üí
  Œ£ _ Œª A‚ÇÄ‚ÇÅ ‚Üí in-U~ a‚Å∞ a¬π A‚ÇÄ‚ÇÅ
projœÄ~‚ÇÅ' {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A~‚ÇÄ}{A~‚ÇÅ}{a~‚ÇÄ}{a~‚ÇÅ}{B‚ÇÄ}{B‚ÇÅ}{b‚ÇÄ}{b‚ÇÅ}{B~‚ÇÄ}{B~‚ÇÅ}{b~‚ÇÄ}{b~‚ÇÅ} w = _ ,Œ£ proj‚ÇÅ (proj‚ÇÇ ( pj-œÄ~ {a‚ÇÄ = œÄ a‚ÇÄ a~‚ÇÄ b‚ÇÄ b~‚ÇÄ}{a‚ÇÅ = œÄ a‚ÇÅ a~‚ÇÅ b‚ÇÅ b~‚ÇÅ} w ))

pj~-ty : (p0 : ‚ä§ ‚äé œÄ-data) (p1 : ‚ä§ ‚äé œÄ-data) ‚Üí pj-œÄ~-ty p0 p1 ‚Üí (A‚ÇÄ A‚ÇÅ : Set) ‚Üí (A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop) ‚Üí Set‚ÇÅ
pj~-ty (inj‚ÇÅ x) y _ _ _ _ = ‚ä§'
pj~-ty (inj‚ÇÇ y‚ÇÅ) (inj‚ÇÅ x) _ _ _ _ = ‚ä§'
pj~-ty (inj‚ÇÇ record { A = A‚ÇÄ ; A~ = A‚ÇÄ~ ; B = B‚ÇÄ ; B~ = B‚ÇÄ~ ; a = a‚ÇÄ ; a~ = a‚ÇÄ~ ; b = b‚ÇÄ ; b~ = b‚ÇÄ~ })
    (inj‚ÇÇ record { A = A‚ÇÅ ; A~ = A‚ÇÅ~ ; B = B‚ÇÅ ; B~ = B‚ÇÅ~ ; a = a‚ÇÅ ; a~ = a‚ÇÅ~ ; b = b‚ÇÅ ; b~ = b‚ÇÅ~ })
    (A‚ÇÄ‚ÇÅ ,Œ£ (_ ,Œ£ (B‚ÇÄ‚ÇÅ ,Œ£ _))) T0 T1 T~ =
    (e0 : T0 ‚â°p Œ£sp ((x : A‚ÇÄ) ‚Üí B‚ÇÄ x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A‚ÇÄ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÄ~ (un‚Üëps x‚ÇÄ‚ÇÅ) (f x‚ÇÄ) (f x‚ÇÅ)))
    (e1 : T1 ‚â°p Œ£sp ((x : A‚ÇÅ) ‚Üí B‚ÇÅ x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÅ~ (un‚Üëps x‚ÇÄ‚ÇÅ) (f x‚ÇÄ) (f x‚ÇÅ)))
    ‚Üí transp-‚â°p (Œª x ‚Üí x ‚Üí _ ‚Üí _) e0 (transp-‚â°p (Œª x ‚Üí _ ‚Üí x ‚Üí _) e1 T~) ‚â° Œª { f‚ÇÄ f‚ÇÅ ‚Üí (x‚ÇÄ : A‚ÇÄ)(x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÄ‚ÇÅ (un‚Üëps x‚ÇÄ‚ÇÅ) (proj‚ÇÅsp f‚ÇÄ x‚ÇÄ) (proj‚ÇÅsp f‚ÇÅ x‚ÇÅ)}

pj~ : {A‚ÇÄ A‚ÇÅ : Set} {a‚ÇÄ : in-U A‚ÇÄ} {a‚ÇÅ : in-U A‚ÇÅ} {A~ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}
    ‚Üí (x : in-U~ a‚ÇÄ a‚ÇÅ A~)
    ‚Üí pj~-ty (get-œÄ-data a‚ÇÄ) (get-œÄ-data a‚ÇÅ) (pj-œÄ~ x) A‚ÇÄ A‚ÇÅ A~
pj~ = simple.ind-in-U~ (Œª _ ‚Üí ‚ä§) (Œª {A‚ÇÄ} {A‚ÇÅ} {a‚ÇÄ} {a‚ÇÅ} {A~} x ‚Üí pj~-ty (get-œÄ-data a‚ÇÄ) (get-œÄ-data a‚ÇÅ) (pj-œÄ~ x) A‚ÇÄ A‚ÇÅ A~)
  tt (Œª _ _ _ _ ‚Üí tt) (Œª z ‚Üí z) Œª _ _ _ _ _ _ _ _ _ _ e0 e1 ‚Üí to-‚â° reflp

projœÄ~‚ÇÉ :
  {A‚ÇÄ : Set}{A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}
  {A~‚ÇÄ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{A~‚ÇÅ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a~‚ÇÄ : in-U~ a‚ÇÄ a‚ÇÄ A~‚ÇÄ}{a~‚ÇÅ : in-U~ a‚ÇÅ a‚ÇÅ A~‚ÇÅ}
  {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÄ : (x : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x)}{b‚ÇÅ : (x : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x)}
  {B~‚ÇÄ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A~‚ÇÄ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}{B~‚ÇÅ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A~‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
  {b~‚ÇÄ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A~‚ÇÄ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B~‚ÇÄ x‚ÇÄ‚ÇÅ)}{b~‚ÇÅ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A~‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B~‚ÇÅ x‚ÇÄ‚ÇÅ)} ‚Üí
  ‚àÄ{C‚ÇÄ‚ÇÅ}(c‚ÇÄ‚ÇÅ : in-U~ (œÄ a‚ÇÄ a~‚ÇÄ b‚ÇÄ b~‚ÇÄ) (œÄ a‚ÇÅ a~‚ÇÅ b‚ÇÅ b~‚ÇÅ) C‚ÇÄ‚ÇÅ) ‚Üí
  C‚ÇÄ‚ÇÅ ‚â° (Œª f‚ÇÄ f‚ÇÅ ‚Üí (x‚ÇÄ : A‚ÇÄ)(x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : ‚Üëps (proj‚ÇÅ (pj-œÄ~ {a‚ÇÄ = œÄ a‚ÇÄ a~‚ÇÄ b‚ÇÄ b~‚ÇÄ}{œÄ a‚ÇÅ a~‚ÇÅ b‚ÇÅ b~‚ÇÅ} c‚ÇÄ‚ÇÅ) x‚ÇÄ x‚ÇÅ)) ‚Üí proj‚ÇÅ (proj‚ÇÇ (proj‚ÇÇ (pj-œÄ~ c‚ÇÄ‚ÇÅ))) (un‚Üëps x‚ÇÄ‚ÇÅ) (proj‚ÇÅsp f‚ÇÄ x‚ÇÄ) (proj‚ÇÅsp f‚ÇÅ x‚ÇÅ))
projœÄ~‚ÇÉ {A‚ÇÄ}{A‚ÇÅ}{a‚ÇÄ}{a‚ÇÅ}{A~‚ÇÄ}{A~‚ÇÅ}{a~‚ÇÄ}{a~‚ÇÅ}{B‚ÇÄ}{B‚ÇÅ}{b‚ÇÄ}{b‚ÇÅ}{B~‚ÇÄ}{B~‚ÇÅ}{b~‚ÇÄ}{b~‚ÇÅ} x = pj~ x reflp reflp

