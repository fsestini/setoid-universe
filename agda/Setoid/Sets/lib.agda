{-# OPTIONS --allow-unsolved-metas --without-K --prop #-}

module Setoid.Sets.lib where

-- it is not allowed to open this module outside of Setoid

open import Agda.Primitive
open import Setoid.lib

data in-U : Set ‚Üí Set‚ÇÅ
data in-U~ : {A‚ÇÄ A‚ÇÅ : Set}(a‚ÇÄ : in-U A‚ÇÄ)(a‚ÇÅ : in-U A‚ÇÅ)(A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop) ‚Üí Set‚ÇÅ

data in-U where
  bool : in-U ùüö
  œÄ : {A : Set}(a : in-U A){A~ : A ‚Üí A ‚Üí Prop}(a~ : in-U~ a a A~)
      
      {B : A ‚Üí Set}(b : (x : A) ‚Üí in-U (B x))
      {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
      (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)) ‚Üí
      
      in-U (Œ£sp ((x : A) ‚Üí B x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A)(x‚ÇÄ‚ÇÅ : ‚Üëps (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí B~ (un‚Üëps x‚ÇÄ‚ÇÅ) (f x‚ÇÄ) (f x‚ÇÅ)))

data in-U~ where
  bool~ : in-U~ bool bool Œª x‚ÇÄ x‚ÇÅ ‚Üí x‚ÇÄ ‚âüùüö x‚ÇÅ
  œÄ~ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}
       {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}
       {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ)

       {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}
         {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
         {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
       {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}
         {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
         {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
       {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
       (b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
        
       in-U~ (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ {B‚ÇÄ~} b‚ÇÄ~)
             (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ {B‚ÇÅ~} b‚ÇÅ~)
             (Œª {(f‚ÇÄ ,sp f‚ÇÄ~) (f‚ÇÅ ,sp f‚ÇÅ~) ‚Üí (x‚ÇÄ : A‚ÇÄ)(x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÄ‚ÇÅ (un‚Üëps x‚ÇÄ‚ÇÅ) (f‚ÇÄ x‚ÇÄ) (f‚ÇÅ x‚ÇÅ)})

module simple
  {i}
  {j}
  (in-U·¥∞ : ‚àÄ{A : Set} ‚Üí in-U A ‚Üí Set i)
  (in-U~·¥∞ : {A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí Set j)
  (bool·¥∞ : in-U·¥∞ bool)
  (œÄ·¥∞ : {A : Set}{a : in-U A}(a·¥∞ : in-U·¥∞ a){A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}(a~·¥∞ : in-U~·¥∞ a~)
    {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}(b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
    (b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b~ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U·¥∞ (œÄ a a~ b b~))
  (bool~·¥∞ : in-U~·¥∞ bool~)
  (œÄ~·¥∞ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}(a‚ÇÄ~·¥∞ : in-U~·¥∞ a‚ÇÄ~)
    {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}(a‚ÇÅ~·¥∞ : in-U~·¥∞ a‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ a‚ÇÄ‚ÇÅ)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}(b‚ÇÄ·¥∞ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U·¥∞ (b‚ÇÄ x‚ÇÄ))
      {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}(b‚ÇÅ·¥∞ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U·¥∞ (b‚ÇÅ x‚ÇÅ))
      {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U~·¥∞ (œÄ~ {a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ))
  where
    
  ind-in-U : ‚àÄ{A : Set}(a : in-U A) ‚Üí in-U·¥∞ a
  ind-in-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ a‚ÇÄ‚ÇÅ
  ind-in-U bool = bool·¥∞
  ind-in-U (œÄ a {A~ = A~} a~ b b~) = œÄ·¥∞ (ind-in-U a) (ind-in-U~ a~) (Œª x ‚Üí ind-in-U (b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b~ x‚ÇÄ‚ÇÅ))
  ind-in-U~ bool~ = bool~·¥∞
  ind-in-U~ (œÄ~ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ = a‚ÇÅ}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ}{b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ = b‚ÇÅ}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ) =
    œÄ~·¥∞ (ind-in-U a‚ÇÄ) (ind-in-U~ a‚ÇÄ~) (ind-in-U a‚ÇÅ) (ind-in-U~ a‚ÇÅ~) (ind-in-U~ a‚ÇÄ‚ÇÅ)
      (Œª x ‚Üí ind-in-U (b‚ÇÄ x)) (Œª x ‚Üí ind-in-U~ (b‚ÇÄ~ x)) (Œª x ‚Üí ind-in-U (b‚ÇÅ x)) (Œª x ‚Üí ind-in-U~ (b‚ÇÅ~ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ))

module double
  {i}
  (in-U·¥∞ : ‚àÄ{A‚Å∞ A¬π : Set} ‚Üí in-U A‚Å∞ ‚Üí in-U A¬π ‚Üí Set i)
  (boolbool·¥∞ : in-U·¥∞ bool bool)
  (boolœÄ·¥∞ : {A : Set}(a : in-U A){A~ : A ‚Üí A ‚Üí Prop}(a~ : in-U~ a a A~)
    {B : A ‚Üí Set}(b : (x : A) ‚Üí in-U (B x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)) ‚Üí  in-U·¥∞ bool (œÄ a a~ b b~))
  (œÄbool·¥∞ : {A : Set}(a : in-U A){A~ : A ‚Üí A ‚Üí Prop}(a~ : in-U~ a a A~)
    {B : A ‚Üí Set}(b : (x : A) ‚Üí in-U (B x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)) ‚Üí  in-U·¥∞ (œÄ a a~ b b~) bool)
  (œÄœÄ·¥∞ : {A‚Å∞ : Set}{A¬π : Set}{a‚Å∞ : in-U A‚Å∞}{a¬π : in-U A¬π}(a·¥∞ : in-U·¥∞ a‚Å∞ a¬π)
    {A~‚Å∞ : A‚Å∞ ‚Üí A‚Å∞ ‚Üí Prop}{A~¬π : A¬π ‚Üí A¬π ‚Üí Prop}(a~‚Å∞ : in-U~ a‚Å∞ a‚Å∞ A~‚Å∞)(a~¬π : in-U~ a¬π a¬π A~¬π)
    {B‚Å∞ : A‚Å∞ ‚Üí Set}{B¬π : A¬π ‚Üí Set}{b‚Å∞ : (x : A‚Å∞) ‚Üí in-U (B‚Å∞ x)}{b¬π : (x : A¬π) ‚Üí in-U (B¬π x)}(b·¥∞ : (x‚Å∞ : A‚Å∞)(x¬π : A¬π) ‚Üí in-U·¥∞ (b‚Å∞ x‚Å∞) (b¬π x¬π))
    {B~‚Å∞ : {x‚ÇÄ x‚ÇÅ : A‚Å∞}(x‚ÇÄ‚ÇÅ : A~‚Å∞ x‚ÇÄ x‚ÇÅ) ‚Üí B‚Å∞ x‚ÇÄ ‚Üí B‚Å∞ x‚ÇÅ ‚Üí Prop}{B~¬π : {x‚ÇÄ x‚ÇÅ : A¬π}(x‚ÇÄ‚ÇÅ : A~¬π x‚ÇÄ x‚ÇÅ) ‚Üí B¬π x‚ÇÄ ‚Üí B¬π x‚ÇÅ ‚Üí Prop}
    (b~‚Å∞ : {x‚ÇÄ x‚ÇÅ : A‚Å∞}(x‚ÇÄ‚ÇÅ : A~‚Å∞ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚Å∞ x‚ÇÄ) (b‚Å∞ x‚ÇÅ) (B~‚Å∞ x‚ÇÄ‚ÇÅ))(b~¬π : {x‚ÇÄ x‚ÇÅ : A¬π}(x‚ÇÄ‚ÇÅ : A~¬π x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b¬π x‚ÇÄ) (b¬π x‚ÇÅ) (B~¬π x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U·¥∞ (œÄ a‚Å∞ a~‚Å∞ b‚Å∞ b~‚Å∞) (œÄ a¬π a~¬π b¬π b~¬π))
  where
  ind-in-U : ‚àÄ{A‚Å∞ : Set}(a‚Å∞ : in-U A‚Å∞){A¬π : Set}(a¬π : in-U A¬π) ‚Üí in-U·¥∞ a‚Å∞ a¬π
  ind-in-U = simple.ind-in-U (Œª a‚Å∞ ‚Üí ‚àÄ{A¬π}(a¬π : in-U A¬π) ‚Üí in-U·¥∞ a‚Å∞ a¬π) (Œª _ ‚Üí ‚ä§)
    (simple.ind-in-U (Œª a¬π ‚Üí in-U·¥∞ bool a¬π) (Œª _ ‚Üí ‚ä§) boolbool·¥∞ (Œª {A}{a} _ {A~}{a~} _ {B}{b} _ {B~}{b~} _ ‚Üí boolœÄ·¥∞ a a~ b b~) tt (Œª _ _ _ _ _ _ _ _ _ _ ‚Üí tt))
    (Œª {A‚Å∞}{a‚Å∞} a·¥∞' {A~‚Å∞}{a~‚Å∞} _ {B‚Å∞}{b‚Å∞} b·¥∞' {B~‚Å∞}{b~‚Å∞} _ ‚Üí simple.ind-in-U
      (Œª c¬π ‚Üí in-U·¥∞ (œÄ a‚Å∞ a~‚Å∞ b‚Å∞ b~‚Å∞) c¬π) (Œª _ ‚Üí ‚ä§)
      (œÄbool·¥∞ a‚Å∞ a~‚Å∞ b‚Å∞ b~‚Å∞)
      (Œª {A¬π}{a¬π} a·¥∞ {A~¬π}{a~¬π} _ {B¬π}{b¬π} b·¥∞ {B~¬π}{b~¬π} _ ‚Üí œÄœÄ·¥∞ {a‚Å∞ = a‚Å∞}{a¬π} (a·¥∞' a¬π) a~‚Å∞ a~¬π {b‚Å∞ = b‚Å∞}{b¬π} (Œª x‚Å∞ x¬π ‚Üí b·¥∞' x‚Å∞ (b¬π x¬π)) b~‚Å∞ b~¬π)
      tt Œª _ _ _ _ _ _ _ _ _ _ ‚Üí tt)
    tt (Œª _ _ _ _ _ _ _ _ _ _ ‚Üí tt)
  {-
  ind-in-U bool bool = boolbool·¥∞
  ind-in-U bool (œÄ a a~ b b~) = boolœÄ·¥∞ a a~ b b~
  ind-in-U (œÄ a a~ b b~) bool = œÄbool·¥∞ a a~ b b~
  ind-in-U (œÄ a‚Å∞ a~‚Å∞ b‚Å∞ b~‚Å∞) (œÄ a¬π a~¬π b¬π b~¬π) = œÄœÄ·¥∞ (ind-in-U a‚Å∞ a¬π) a~‚Å∞ a~¬π (Œª x‚Å∞ x¬π ‚Üí ind-in-U (b‚Å∞ x‚Å∞) (b¬π x¬π)) b~‚Å∞ b~¬π
  -}

module _
  {i}
  (theT : ‚àÄ{A‚ÇÄ A‚ÇÅ A‚ÇÇ} (a‚ÇÄ : in-U A‚ÇÄ) (a‚ÇÅ : in-U A‚ÇÅ) (a‚ÇÇ : in-U A‚ÇÇ) ‚Üí Set i)
  (b-b-b : theT bool bool bool)
  (b-b-p : {A : Set} {a : in-U A} {A~ : A -> A -> Prop} {a~ : in-U~ a a A~}
           {B : A -> Set} {b : (x : A) -> in-U (B x)}
           {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
           {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
         ‚Üí theT bool bool (œÄ a a~ b b~))
  (b-p-x : {A : Set} {a : in-U A} {A~ : A -> A -> Prop} {a~ : in-U~ a a A~}
           {B : A -> Set} {b : (x : A) -> in-U (B x)}
           {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
           {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
           {A' : Set} {x : in-U A'}
         ‚Üí theT bool (œÄ a a~ b b~) x)
  (p-b-x : {A : Set} {a : in-U A} {A~ : A -> A -> Prop} {a~ : in-U~ a a A~}
           {B : A -> Set} {b : (x : A) -> in-U (B x)}
           {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
           {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
           {A' : Set} {x : in-U A'}
         ‚Üí theT (œÄ a a~ b b~) bool x)
  (p-p-b : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}
           {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}
           {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}
           {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
           {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
           {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}
           {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
           {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
         ‚Üí theT a‚ÇÅ a‚ÇÄ a‚ÇÄ
         ‚Üí theT a‚ÇÄ a‚ÇÅ a‚ÇÄ
         ‚Üí theT a‚ÇÅ a‚ÇÅ a‚ÇÄ
         ‚Üí ((x‚ÇÄ x‚ÇÅ : A‚ÇÄ) (x‚ÇÇ : A‚ÇÅ) ‚Üí theT (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (b‚ÇÅ x‚ÇÇ))
         ‚Üí ((x‚ÇÄ : A‚ÇÅ) (x‚ÇÅ : A‚ÇÄ) (x‚ÇÇ : A‚ÇÅ) ‚Üí theT (b‚ÇÅ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (b‚ÇÅ x‚ÇÇ))
         ‚Üí ((x‚ÇÄ : A‚ÇÄ) (x‚ÇÅ : A‚ÇÅ) (x‚ÇÇ : A‚ÇÅ) ‚Üí theT (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (b‚ÇÅ x‚ÇÇ))
         ‚Üí theT (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~) (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~) bool)
  (p-p-p : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}
           {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}
           {A‚ÇÇ : Set}{a‚ÇÇ : in-U A‚ÇÇ}{A‚ÇÇ~ : A‚ÇÇ ‚Üí A‚ÇÇ ‚Üí Prop}{a‚ÇÇ~ : in-U~ a‚ÇÇ a‚ÇÇ A‚ÇÇ~}
           {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}
           {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
           {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
           {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}
           {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
           {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
           {B‚ÇÇ : A‚ÇÇ ‚Üí Set}{b‚ÇÇ : (x‚ÇÅ : A‚ÇÇ) ‚Üí in-U (B‚ÇÇ x‚ÇÅ)}
           {B‚ÇÇ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÇ}(x‚ÇÄ‚ÇÅ : A‚ÇÇ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÇ x‚ÇÄ ‚Üí B‚ÇÇ x‚ÇÅ ‚Üí Prop}
           {b‚ÇÇ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÇ}(x‚ÇÄ‚ÇÅ : A‚ÇÇ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÇ x‚ÇÄ) (b‚ÇÇ x‚ÇÅ) (B‚ÇÇ~ x‚ÇÄ‚ÇÅ)}
         ‚Üí theT a‚ÇÅ a‚ÇÄ a‚ÇÄ -- a100
         ‚Üí theT a‚ÇÄ a‚ÇÅ a‚ÇÄ -- a010
         ‚Üí theT a‚ÇÅ a‚ÇÅ a‚ÇÄ -- a110
         ‚Üí theT a‚ÇÅ a‚ÇÄ a‚ÇÅ -- a101
         ‚Üí theT a‚ÇÄ a‚ÇÅ a‚ÇÇ
         ‚Üí theT a‚ÇÄ a‚ÇÇ a‚ÇÅ
         ‚Üí theT a‚ÇÄ a‚ÇÅ a‚ÇÅ
         ‚Üí theT a‚ÇÇ a‚ÇÅ a‚ÇÅ
         ‚Üí ((x‚ÇÄ x‚ÇÅ : A‚ÇÄ) (x‚ÇÇ : A‚ÇÅ) ‚Üí theT (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (b‚ÇÅ x‚ÇÇ))        -- b001
         ‚Üí ((x‚ÇÄ : A‚ÇÅ) (x‚ÇÅ : A‚ÇÄ) (x‚ÇÇ : A‚ÇÅ) ‚Üí theT (b‚ÇÅ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (b‚ÇÅ x‚ÇÇ)) -- b101
         ‚Üí ((x‚ÇÄ : A‚ÇÄ) (x‚ÇÅ : A‚ÇÅ) (x‚ÇÇ : A‚ÇÅ) ‚Üí theT (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (b‚ÇÅ x‚ÇÇ)) -- b011
         ‚Üí ((x‚ÇÄ : A‚ÇÄ) (x‚ÇÅ : A‚ÇÅ) (x‚ÇÇ : A‚ÇÇ) ‚Üí theT (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (b‚ÇÇ x‚ÇÇ))
         ‚Üí ((x‚ÇÄ : A‚ÇÅ) (x‚ÇÅ : A‚ÇÅ) (x‚ÇÇ : A‚ÇÇ) ‚Üí theT (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (b‚ÇÇ x‚ÇÇ))
         ‚Üí theT (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~) (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~) (œÄ a‚ÇÇ a‚ÇÇ~ b‚ÇÇ b‚ÇÇ~))
  where

  triple : ‚àÄ{A‚ÇÄ A‚ÇÅ A‚ÇÇ} (a‚ÇÄ : in-U A‚ÇÄ) (a‚ÇÅ : in-U A‚ÇÅ) (a‚ÇÇ : in-U A‚ÇÇ) ‚Üí theT a‚ÇÄ a‚ÇÅ a‚ÇÇ
  triple = {!!}

module simpleProp
  {i}
  {j}
  (in-U·¥∞ : ‚àÄ{A : Set} ‚Üí in-U A ‚Üí Prop i)
  (in-U~·¥∞ : {A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí Prop j)
  (bool·¥∞ : in-U·¥∞ bool)
  (œÄ·¥∞ : {A : Set}{a : in-U A}(a·¥∞ : in-U·¥∞ a){A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}(a~·¥∞ : in-U~·¥∞ a~)
    {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}(b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
    (b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b~ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U·¥∞ (œÄ a a~ b b~))
  (bool~·¥∞ : in-U~·¥∞ bool~)
  (œÄ~·¥∞ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}(a‚ÇÄ~·¥∞ : in-U~·¥∞ a‚ÇÄ~)
    {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}(a‚ÇÅ~·¥∞ : in-U~·¥∞ a‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ a‚ÇÄ‚ÇÅ)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}(b‚ÇÄ·¥∞ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U·¥∞ (b‚ÇÄ x‚ÇÄ))
      {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}(b‚ÇÅ·¥∞ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U·¥∞ (b‚ÇÅ x‚ÇÅ))
      {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U~·¥∞ (œÄ~ {a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ))
  where
    
  ind-in-U : ‚àÄ{A : Set}(a : in-U A) ‚Üí in-U·¥∞ a
  ind-in-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ a‚ÇÄ‚ÇÅ
  ind-in-U bool = bool·¥∞
  ind-in-U (œÄ a {A~ = A~} a~ b b~) = œÄ·¥∞ (ind-in-U a) (ind-in-U~ a~) (Œª x ‚Üí ind-in-U (b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b~ x‚ÇÄ‚ÇÅ))
  ind-in-U~ bool~ = bool~·¥∞
  ind-in-U~ (œÄ~ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ = a‚ÇÅ}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ}{b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ = b‚ÇÅ}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ) =
    œÄ~·¥∞ (ind-in-U a‚ÇÄ) (ind-in-U~ a‚ÇÄ~) (ind-in-U a‚ÇÅ) (ind-in-U~ a‚ÇÅ~) (ind-in-U~ a‚ÇÄ‚ÇÅ)
      (Œª x ‚Üí ind-in-U (b‚ÇÄ x)) (Œª x ‚Üí ind-in-U~ (b‚ÇÄ~ x)) (Œª x ‚Üí ind-in-U (b‚ÇÅ x)) (Œª x ‚Üí ind-in-U~ (b‚ÇÅ~ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ))

module general
  {i}
  {j}
  (in-U·¥∞ : ‚àÄ{A : Set} ‚Üí in-U A ‚Üí Set i)
  (in-U~·¥∞ : {A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí Prop j)
  (bool·¥∞ : in-U·¥∞ bool)
  (œÄ·¥∞ : {A : Set}{a : in-U A}(a·¥∞ : in-U·¥∞ a){A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}(a~·¥∞ : in-U~·¥∞ a·¥∞ a·¥∞ a~)
    {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}(b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
    (b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b·¥∞ x‚ÇÄ) (b·¥∞ x‚ÇÅ) (b~ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U·¥∞ (œÄ a a~ b b~))
  (bool~·¥∞ : in-U~·¥∞ bool·¥∞ bool·¥∞ bool~)
  (œÄ~·¥∞ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}(a‚ÇÄ~·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ~)
    {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}(a‚ÇÅ~·¥∞ : in-U~·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÄ‚ÇÅ)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}(b‚ÇÄ·¥∞ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U·¥∞ (b‚ÇÄ x‚ÇÄ))
      {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ·¥∞ x‚ÇÄ) (b‚ÇÄ·¥∞ x‚ÇÅ) (b‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}(b‚ÇÅ·¥∞ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U·¥∞ (b‚ÇÅ x‚ÇÅ))
      {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÅ·¥∞ x‚ÇÄ) (b‚ÇÅ·¥∞ x‚ÇÅ) (b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ·¥∞ x‚ÇÄ) (b‚ÇÅ·¥∞ x‚ÇÅ) (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U~·¥∞ (œÄ·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ~·¥∞ b‚ÇÄ·¥∞ b‚ÇÄ~·¥∞) (œÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~·¥∞ b‚ÇÅ·¥∞ b‚ÇÅ~·¥∞) (œÄ~ {a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ))
  where

  ind-in-U : ‚àÄ{A : Set}(a : in-U A) ‚Üí in-U·¥∞ a
  ind-in-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ (ind-in-U a‚ÇÄ) (ind-in-U a‚ÇÅ) a‚ÇÄ‚ÇÅ
  ind-in-U bool = bool·¥∞
  ind-in-U (œÄ a {A~ = A~} a~ b b~) = œÄ·¥∞ (ind-in-U a) (ind-in-U~ a~) (Œª x ‚Üí ind-in-U (b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b~ x‚ÇÄ‚ÇÅ))
  ind-in-U~ bool~ = bool~·¥∞
  ind-in-U~ (œÄ~ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ = a‚ÇÅ}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ}{b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ = b‚ÇÅ}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ) =
    œÄ~·¥∞ (ind-in-U a‚ÇÄ) (ind-in-U~ a‚ÇÄ~) (ind-in-U a‚ÇÅ) (ind-in-U~ a‚ÇÅ~) (ind-in-U~ a‚ÇÄ‚ÇÅ)
      (Œª x ‚Üí ind-in-U (b‚ÇÄ x)) (Œª x ‚Üí ind-in-U~ (b‚ÇÄ~ x)) (Œª x ‚Üí ind-in-U (b‚ÇÅ x)) (Œª x ‚Üí ind-in-U~ (b‚ÇÅ~ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ))
