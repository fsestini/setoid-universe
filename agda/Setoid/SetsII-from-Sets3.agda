{-# OPTIONS --without-K --prop --rewriting #-}

module Setoid.SetsII-from-Sets3 where

import Setoid.Sets3.mini-univ-encoding as M
open import Setoid.lib
open import lib
open import irrel-eq public
open import Function

module E where

  data in-U : M.U -> Set‚ÇÅ
  data in-U~ : (A‚ÇÄ A‚ÇÅ : M.U) (a‚ÇÄ : in-U A‚ÇÄ)(a‚ÇÅ : in-U A‚ÇÅ)(A‚ÇÄ‚ÇÅ : M.El A‚ÇÄ -> M.El A‚ÇÅ -> M.P) ‚Üí Set‚ÇÅ

  data in-U where
    bool : in-U M.ùüö-U

    œÄ : {A : M.U}(a : in-U A){A~ : M.El A -> M.El A -> M.P}(a~ : in-U~ A A a a A~)
        {B : M.El A -> M.U}
        (b : (x : M.El A) ‚Üí in-U (B x))
        {B~ : {x‚ÇÄ x‚ÇÅ : M.El A}(x‚ÇÄ‚ÇÅ : M.ElP (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí M.El (B x‚ÇÄ) ‚Üí M.El (B x‚ÇÅ) ‚Üí M.P}
        (b~ : {x‚ÇÄ x‚ÇÅ : M.El A}(x‚ÇÄ‚ÇÅ : M.ElP (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (B x‚ÇÄ) (B x‚ÇÅ) (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ))
       ‚Üí in-U (M.Œ£sp-U A B A~ B~)

  data in-U~ where
    bool~ : in-U~ M.ùüö-U M.ùüö-U bool bool (Œª x‚ÇÄ x‚ÇÅ ‚Üí x‚ÇÄ M.‚âüùüö-P x‚ÇÅ)
    œÄ~ : {A‚ÇÄ : M.U}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : M.El A‚ÇÄ ‚Üí M.El A‚ÇÄ ‚Üí M.P}{a‚ÇÄ~ : in-U~ A‚ÇÄ A‚ÇÄ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}
         {A‚ÇÅ : M.U}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : M.El A‚ÇÅ ‚Üí M.El A‚ÇÅ ‚Üí M.P}{a‚ÇÅ~ : in-U~ A‚ÇÅ A‚ÇÅ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}
         {A‚ÇÄ‚ÇÅ : M.El A‚ÇÄ ‚Üí M.El A‚ÇÅ ‚Üí M.P}(a‚ÇÄ‚ÇÅ : in-U~ A‚ÇÄ A‚ÇÅ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ)
    
         {B‚ÇÄ : M.El A‚ÇÄ ‚Üí M.U}{b‚ÇÄ : (x‚ÇÄ : M.El A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}
           {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : M.El A‚ÇÄ}(x‚ÇÄ‚ÇÅ : M.ElP (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí M.El (B‚ÇÄ x‚ÇÄ) ‚Üí M.El (B‚ÇÄ x‚ÇÅ) ‚Üí M.P}
           {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : M.El A‚ÇÄ}(x‚ÇÄ‚ÇÅ : M.ElP (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (B‚ÇÄ x‚ÇÄ) (B‚ÇÄ x‚ÇÅ) (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
         {B‚ÇÅ : M.El A‚ÇÅ ‚Üí M.U}{b‚ÇÅ : (x‚ÇÅ : M.El A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}
           {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : M.El A‚ÇÅ}(x‚ÇÄ‚ÇÅ : M.ElP (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí M.El (B‚ÇÅ x‚ÇÄ) ‚Üí M.El (B‚ÇÅ x‚ÇÅ) ‚Üí M.P}
           {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : M.El A‚ÇÅ}(x‚ÇÄ‚ÇÅ : M.ElP (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (B‚ÇÅ x‚ÇÄ) (B‚ÇÅ x‚ÇÅ) (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
         {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : M.El A‚ÇÄ}{x‚ÇÅ : M.El A‚ÇÅ}(x‚ÇÄ‚ÇÅ : M.ElP (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí M.El (B‚ÇÄ x‚ÇÄ) ‚Üí M.El (B‚ÇÅ x‚ÇÅ) ‚Üí M.P}
         (b‚ÇÄ‚ÇÅ : {x‚ÇÄ : M.El A‚ÇÄ}{x‚ÇÅ : M.El A‚ÇÅ}(x‚ÇÄ‚ÇÅ : M.ElP (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (B‚ÇÄ x‚ÇÄ) (B‚ÇÅ x‚ÇÅ) (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ))
     ‚Üí in-U~ _ _ (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ {B‚ÇÄ~} b‚ÇÄ~) (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ {B‚ÇÅ~} b‚ÇÅ~)
         Œª x y ‚Üí M.fun-‚â°-P A‚ÇÄ A‚ÇÅ A‚ÇÄ‚ÇÅ B‚ÇÄ B‚ÇÅ B‚ÇÄ‚ÇÅ (proj‚ÇÅsp x) (proj‚ÇÅsp y)


in-U : Set ‚Üí Set‚ÇÅ
in-U A = Œ£ _ Œª inu ‚Üí E.in-U (A ,Œ£ inu)

in-U~ : {A‚ÇÄ A‚ÇÅ : Set}(a‚ÇÄ : in-U A‚ÇÄ)(a‚ÇÅ : in-U A‚ÇÅ)(A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop) ‚Üí Set‚ÇÅ
in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ =
  Œ£ (‚àÄ x y ‚Üí M.in-P (A‚ÇÄ‚ÇÅ x y)) Œª inp
    ‚Üí E.in-U~ (_ ,Œ£ proj‚ÇÅ a‚ÇÄ) (_ ,Œ£ proj‚ÇÅ a‚ÇÅ) (proj‚ÇÇ a‚ÇÄ) (proj‚ÇÇ a‚ÇÅ)
        (Œª x y ‚Üí A‚ÇÄ‚ÇÅ x y ,Œ£ inp x y)

bool : in-U ùüö
bool = _ ,Œ£ E.bool

œÄ : {A : Set}(a : in-U A){A~ : A ‚Üí A ‚Üí Prop}(a~ : in-U~ a a A~)
    {B : A ‚Üí Set}(b : (x : A) ‚Üí in-U (B x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)) ‚Üí
    in-U (Œ£sp ((x : A) ‚Üí B x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A)(x‚ÇÄ‚ÇÅ : ‚Üëps (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí B~ (un‚Üëps x‚ÇÄ‚ÇÅ) (f x‚ÇÄ) (f x‚ÇÅ)))
œÄ a a~ b b~ = _ ,Œ£ E.œÄ (proj‚ÇÇ a) (proj‚ÇÇ a~) (Œª x ‚Üí proj‚ÇÇ (b x)) Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÇ (b~ x‚ÇÄ‚ÇÅ)

bool~ : in-U~ bool bool Œª x‚ÇÄ x‚ÇÅ ‚Üí x‚ÇÄ ‚âüùüö x‚ÇÅ
bool~ = _ ,Œ£ E.bool~

œÄ~ :
  {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}
  {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}
  {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ)
  {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}
    {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
  {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}
    {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
  {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
  (b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
  in-U~ (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ {B‚ÇÄ~} b‚ÇÄ~)
        (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ {B‚ÇÅ~} b‚ÇÅ~)
        (Œª {(f‚ÇÄ ,sp f‚ÇÄ~) (f‚ÇÅ ,sp f‚ÇÅ~) ‚Üí (x‚ÇÄ : A‚ÇÄ)(x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : ‚Üëps (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí B‚ÇÄ‚ÇÅ (un‚Üëps x‚ÇÄ‚ÇÅ) (f‚ÇÄ x‚ÇÄ) (f‚ÇÅ x‚ÇÅ)})
œÄ~ a‚ÇÄ‚ÇÅ b‚ÇÄ‚ÇÅ = _ ,Œ£ E.œÄ~ (proj‚ÇÇ a‚ÇÄ‚ÇÅ) Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÇ (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)

module general
  {i}
  {j}
  (in-U·¥∞ : ‚àÄ{A : Set} ‚Üí in-U A ‚Üí Set i)
  (in-U~·¥∞ : {A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí Set j)
  (bool·¥∞ : in-U·¥∞ bool)
  (œÄ·¥∞ : {A : Set}{a : in-U A}(a·¥∞ : in-U·¥∞ a){A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}(a~·¥∞ : in-U~·¥∞ a·¥∞ a·¥∞ a~)
    {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}(b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí (B x‚ÇÄ) ‚Üí (B x‚ÇÅ) ‚Üí Prop}
    {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
    (b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~·¥∞ (b·¥∞ x‚ÇÄ) (b·¥∞ x‚ÇÅ) (b~ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U·¥∞ (œÄ a a~ b b~))
  (bool~·¥∞ : in-U~·¥∞ bool·¥∞ bool·¥∞ bool~)
  (œÄ~·¥∞ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}(a‚ÇÄ~·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ~)
    {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}(a‚ÇÅ~·¥∞ : in-U~·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÄ‚ÇÅ)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}(b‚ÇÄ·¥∞ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U·¥∞ (b‚ÇÄ x‚ÇÄ))
      {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí (B‚ÇÄ x‚ÇÄ) ‚Üí (B‚ÇÄ x‚ÇÅ) ‚Üí Prop}
      {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~·¥∞ (b‚ÇÄ·¥∞ x‚ÇÄ) (b‚ÇÄ·¥∞ x‚ÇÅ) (b‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}(b‚ÇÅ·¥∞ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U·¥∞ (b‚ÇÅ x‚ÇÅ))
      {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí (B‚ÇÅ x‚ÇÄ) ‚Üí (B‚ÇÅ x‚ÇÅ) ‚Üí Prop}
      {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~·¥∞ (b‚ÇÅ·¥∞ x‚ÇÄ) (b‚ÇÅ·¥∞ x‚ÇÅ) (b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí (B‚ÇÄ x‚ÇÄ) ‚Üí (B‚ÇÅ x‚ÇÅ) ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~·¥∞ (b‚ÇÄ·¥∞ x‚ÇÄ) (b‚ÇÅ·¥∞ x‚ÇÅ) (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U~·¥∞ (œÄ·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ~·¥∞ b‚ÇÄ·¥∞ b‚ÇÄ~·¥∞) (œÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~·¥∞ b‚ÇÅ·¥∞ b‚ÇÅ~·¥∞) (œÄ~ {a‚ÇÄ = a‚ÇÄ} {a‚ÇÄ~ = a‚ÇÄ~} {a‚ÇÅ = a‚ÇÅ} {a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ} {b‚ÇÄ~ = b‚ÇÄ~} {b‚ÇÅ = b‚ÇÅ} {b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ))
  where

  elim-U' : ‚àÄ{u} (a : E.in-U u) ‚Üí in-U·¥∞ (proj‚ÇÇ u ,Œ£ a)
  elim-U~' : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : _}
          (a‚ÇÄ‚ÇÅ : E.in-U~ _ _ (proj‚ÇÇ a‚ÇÄ) (proj‚ÇÇ a‚ÇÅ) A‚ÇÄ‚ÇÅ)
          ‚Üí in-U~·¥∞ (elim-U' (proj‚ÇÇ a‚ÇÄ)) (elim-U' (proj‚ÇÇ a‚ÇÅ)) (_ ,Œ£ a‚ÇÄ‚ÇÅ)

  elim-U' E.bool = bool·¥∞
  elim-U' (E.œÄ a a~ b b~) = œÄ·¥∞ (elim-U' a) (elim-U~' a~) (Œª x ‚Üí elim-U' (b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí elim-U~' (b~ x‚ÇÄ‚ÇÅ))

  elim-U~' E.bool~ = bool~·¥∞
  elim-U~' (E.œÄ~ a‚ÇÄ‚ÇÅ b‚ÇÄ‚ÇÅ) = œÄ~·¥∞ _ _ _ _ (elim-U~' a‚ÇÄ‚ÇÅ) _ _ _ _ Œª x‚ÇÄ‚ÇÅ ‚Üí elim-U~' (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)

  elim-U : {A : Set} (a : in-U A) ‚Üí in-U·¥∞ a
  elim-U a = elim-U' (proj‚ÇÇ a)
  
  elim-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}
           (a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ (elim-U a‚ÇÄ) (elim-U a‚ÇÅ) a‚ÇÄ‚ÇÅ
  elim-U~ a‚ÇÄ‚ÇÅ = elim-U~' (proj‚ÇÇ a‚ÇÄ‚ÇÅ)

  bool-Œ≤ : elim-U bool ‚â° bool·¥∞
  bool-Œ≤ = refl

  œÄ-Œ≤ :
    {A : Set}(a : in-U A){A~ : A -> A -> Prop}(a~ : in-U~ a a A~)
    {B : A -> Set}
    (b : (x : A) ‚Üí in-U (B x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ :  (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí (B x‚ÇÄ) ‚Üí (B x‚ÇÅ) ‚Üí Prop}
    (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ :  (A~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ))
    ‚Üí elim-U (œÄ a a~ b b~)
    ‚â° œÄ·¥∞ (elim-U a) (elim-U~ a~) (Œª x ‚Üí elim-U (b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí elim-U~ (b~ x‚ÇÄ‚ÇÅ))
  œÄ-Œ≤ a a~ b b~ = refl


  bool~-Œ≤ : elim-U~ bool~ ‚â° bool~·¥∞
  bool~-Œ≤ = refl

  œÄ~-Œ≤ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}
       {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}
       {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ)
  
       {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}
         {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ :  (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí (B‚ÇÄ x‚ÇÄ) ‚Üí (B‚ÇÄ x‚ÇÅ) ‚Üí Prop}
         {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ :  (A‚ÇÄ~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
       {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}
         {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ :  (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí (B‚ÇÅ x‚ÇÄ) ‚Üí (B‚ÇÅ x‚ÇÅ) ‚Üí Prop}
         {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ :  (A‚ÇÅ~ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
       {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ :  (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí (B‚ÇÄ x‚ÇÄ) ‚Üí (B‚ÇÅ x‚ÇÅ) ‚Üí Prop}
       (b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ :  (A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ)) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ))
     ‚Üí elim-U~ (œÄ~ {a‚ÇÄ = a‚ÇÄ} {a‚ÇÄ~ = a‚ÇÄ~} {a‚ÇÅ = a‚ÇÅ} {a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ
                     {b‚ÇÄ = b‚ÇÄ} {b‚ÇÄ~ = b‚ÇÄ~} {b‚ÇÅ = b‚ÇÅ} {b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ)
     ‚â° œÄ~·¥∞ (elim-U a‚ÇÄ) (elim-U~ a‚ÇÄ~) (elim-U a‚ÇÅ) (elim-U~ a‚ÇÅ~) (elim-U~ a‚ÇÄ‚ÇÅ)
           (Œª x‚ÇÄ ‚Üí elim-U (b‚ÇÄ x‚ÇÄ)) (Œª x‚ÇÄ‚ÇÅ ‚Üí elim-U~ (b‚ÇÄ~ x‚ÇÄ‚ÇÅ)) (Œª x‚ÇÅ ‚Üí elim-U (b‚ÇÅ x‚ÇÅ)) (Œª x‚ÇÄ‚ÇÅ ‚Üí elim-U~ (b‚ÇÅ~ x‚ÇÄ‚ÇÅ)) Œª x‚ÇÄ‚ÇÅ ‚Üí elim-U~ (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)
  œÄ~-Œ≤ a‚ÇÄ‚ÇÅ b‚ÇÄ‚ÇÅ = refl

