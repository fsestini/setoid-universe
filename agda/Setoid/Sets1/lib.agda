{-# OPTIONS --without-K --prop #-}

module Setoid.Sets1.lib where

-- constructing in-U and in-U~ using preterms and a typing relation

open import Setoid.lib

-- Sets1

data in-Uâ‚š : Set â†’ Setâ‚
data in-U~â‚š : {Aâ‚€ Aâ‚ : Set}(Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop) â†’ Setâ‚

data in-Uâ‚š where
  boolâ‚š : in-Uâ‚š ğŸš
  Ï€â‚š :
    {A : Set}(aâ‚š : in-Uâ‚š A){A~ : A â†’ A â†’ Prop}(a~â‚š : in-U~â‚š A~)
    {B : A â†’ Set}(bâ‚š : (x : A) â†’ in-Uâ‚š (B x))
    {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}
    (b~â‚š : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~â‚š (B~ xâ‚€â‚)) â†’ 
    in-Uâ‚š (Î£sp ((x : A) â†’ B x) (Î» f â†’ (xâ‚€ xâ‚ : A)(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B~ xâ‚€â‚ (f xâ‚€) (f xâ‚)))

data in-U~â‚š where
  bool~â‚š : in-U~â‚š Î» xâ‚€ xâ‚ â†’ xâ‚€ â‰ŸğŸš xâ‚
  Ï€~â‚š :
    {Aâ‚€ : Set}(aâ‚€ : in-Uâ‚š Aâ‚€){Aâ‚€~ : Aâ‚€ â†’ Aâ‚€ â†’ Prop}(aâ‚€~ : in-U~â‚š Aâ‚€~)
    {Aâ‚ : Set}(aâ‚ : in-Uâ‚š Aâ‚){Aâ‚~ : Aâ‚ â†’ Aâ‚ â†’ Prop}(aâ‚~ : in-U~â‚š Aâ‚~)
    {Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop}(aâ‚€â‚ : in-U~â‚š Aâ‚€â‚)

    {Bâ‚€ : Aâ‚€ â†’ Set}(bâ‚€ : (x : Aâ‚€) â†’ in-Uâ‚š (Bâ‚€ x))
      {Bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚€ xâ‚ â†’ Prop}
      (bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ in-U~â‚š (Bâ‚€~ xâ‚€â‚))
    {Bâ‚ : Aâ‚ â†’ Set}(bâ‚ : (x : Aâ‚) â†’ in-Uâ‚š (Bâ‚ x))
      {Bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ Bâ‚ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
      (bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ in-U~â‚š (Bâ‚~ xâ‚€â‚))
    {Bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
    (bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ in-U~â‚š (Bâ‚€â‚ xâ‚€â‚)) â†’ 
     
    in-U~â‚š
      {Î£sp ((x : Aâ‚€) â†’ Bâ‚€ x) (Î» f â†’ (xâ‚€ xâ‚ : Aâ‚€)(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ Bâ‚€~ xâ‚€â‚ (f xâ‚€) (f xâ‚))}
      {Î£sp ((x : Aâ‚) â†’ Bâ‚ x) (Î» f â†’ (xâ‚€ xâ‚ : Aâ‚)(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ Bâ‚~ xâ‚€â‚ (f xâ‚€) (f xâ‚))}
      (Î» {(fâ‚€ ,sp fâ‚€~) (fâ‚ ,sp fâ‚~) â†’ (xâ‚€ : Aâ‚€)(xâ‚ : Aâ‚)(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ Bâ‚€â‚ xâ‚€â‚ (fâ‚€ xâ‚€) (fâ‚ xâ‚)})

data in-Uâ‚œ : {A : Set} â†’ in-Uâ‚š A â†’ Propâ‚
data in-U~â‚œ : {Aâ‚€ Aâ‚ : Set}(aâ‚€ : in-Uâ‚š Aâ‚€)(aâ‚ : in-Uâ‚š Aâ‚){Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop} â†’ in-U~â‚š Aâ‚€â‚ â†’ Propâ‚

data in-Uâ‚œ where
  boolâ‚œ : in-Uâ‚œ boolâ‚š
  Ï€â‚œ :
    {A : Set}{aâ‚š : in-Uâ‚š A}(a : in-Uâ‚œ aâ‚š){A~ : A â†’ A â†’ Prop}{a~â‚š : in-U~â‚š A~}(a~ : in-U~â‚œ aâ‚š aâ‚š a~â‚š)
    {B : A â†’ Set}{bâ‚š : (x : A) â†’ in-Uâ‚š (B x)}(b : (x : A) â†’ in-Uâ‚œ (bâ‚š x))
    {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}
    {b~â‚š : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~â‚š (B~ xâ‚€â‚)} â†’
    (b~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~â‚œ (bâ‚š xâ‚€) (bâ‚š xâ‚) (b~â‚š xâ‚€â‚)) â†’
    in-Uâ‚œ (Ï€â‚š aâ‚š a~â‚š bâ‚š b~â‚š)

data in-U~â‚œ where
  bool~â‚œ : in-U~â‚œ boolâ‚š boolâ‚š bool~â‚š
  Ï€~â‚œ :
    {Aâ‚€ : Set}{aâ‚€â‚š : in-Uâ‚š Aâ‚€}(aâ‚€ : in-Uâ‚œ aâ‚€â‚š){Aâ‚€~ : Aâ‚€ â†’ Aâ‚€ â†’ Prop}{aâ‚€~â‚š : in-U~â‚š Aâ‚€~}(aâ‚€~ : in-U~â‚œ aâ‚€â‚š aâ‚€â‚š aâ‚€~â‚š)
    {Aâ‚ : Set}{aâ‚â‚š : in-Uâ‚š Aâ‚}(aâ‚ : in-Uâ‚œ aâ‚â‚š){Aâ‚~ : Aâ‚ â†’ Aâ‚ â†’ Prop}{aâ‚~â‚š : in-U~â‚š Aâ‚~}(aâ‚~ : in-U~â‚œ aâ‚â‚š aâ‚â‚š aâ‚~â‚š)
    {Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop}{aâ‚€â‚â‚š : in-U~â‚š Aâ‚€â‚}(aâ‚€â‚ : in-U~â‚œ aâ‚€â‚š aâ‚â‚š aâ‚€â‚â‚š)
    {Bâ‚€ : Aâ‚€ â†’ Set}{bâ‚€â‚š : (x : Aâ‚€) â†’ in-Uâ‚š (Bâ‚€ x)}(bâ‚€ : (x : Aâ‚€) â†’ in-Uâ‚œ (bâ‚€â‚š x))
    {Bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚€ xâ‚ â†’ Prop}
    {bâ‚€~â‚š : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ in-U~â‚š (Bâ‚€~ xâ‚€â‚)}
    (bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ in-U~â‚œ (bâ‚€â‚š xâ‚€) (bâ‚€â‚š xâ‚) (bâ‚€~â‚š xâ‚€â‚))
    {Bâ‚ : Aâ‚ â†’ Set}{bâ‚â‚š : (x : Aâ‚) â†’ in-Uâ‚š (Bâ‚ x)}(bâ‚ : (x : Aâ‚) â†’ in-Uâ‚œ (bâ‚â‚š x))
    {Bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ Bâ‚ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
    {bâ‚~â‚š : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ in-U~â‚š (Bâ‚~ xâ‚€â‚)}
    (bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ in-U~â‚œ (bâ‚â‚š xâ‚€) (bâ‚â‚š xâ‚) (bâ‚~â‚š xâ‚€â‚))
    {Bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
    {bâ‚€â‚â‚š : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ in-U~â‚š  (Bâ‚€â‚ xâ‚€â‚)}
    (bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ in-U~â‚œ (bâ‚€â‚š xâ‚€) (bâ‚â‚š xâ‚) (bâ‚€â‚â‚š xâ‚€â‚)) â†’
    in-U~â‚œ (Ï€â‚š aâ‚€â‚š aâ‚€~â‚š bâ‚€â‚š bâ‚€~â‚š) (Ï€â‚š aâ‚â‚š aâ‚~â‚š bâ‚â‚š bâ‚~â‚š)
      (Ï€~â‚š aâ‚€â‚š aâ‚€~â‚š aâ‚â‚š aâ‚~â‚š aâ‚€â‚â‚š bâ‚€â‚š bâ‚€~â‚š bâ‚â‚š bâ‚~â‚š bâ‚€â‚â‚š)
{-
projâ‚-in-Uâ‚œ-Ï€ :
  {A : Set}{aâ‚š : in-Uâ‚š A}{A~ : A â†’ A â†’ Prop}{a~â‚š : in-U~â‚š A~}
  {B : A â†’ Set}{bâ‚š : (x : A) â†’ in-Uâ‚š (B x)}
  {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}
  {b~â‚š : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~â‚š (B~ xâ‚€â‚)}
  {C : Set}{câ‚š : in-Uâ‚š C}(câ‚œ : in-Uâ‚œ câ‚š)
  (e : C â‰¡ (Î£sp ((x : A) â†’ B x) (Î» f â†’ (xâ‚€ xâ‚ : A)(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B~ xâ‚€â‚ (f xâ‚€) (f xâ‚))))
  (e' : transport in-Uâ‚š e câ‚š â‰¡ Ï€â‚š aâ‚š a~â‚š bâ‚š b~â‚š) â†’
  in-Uâ‚œ aâ‚š
projâ‚-in-Uâ‚œ-Ï€ boolâ‚œ e e' = {!c!}
projâ‚-in-Uâ‚œ-Ï€ (Ï€â‚œ a a~ b b~) e e' = {!!}
-}
{-
ind-in-Uâ‚œ :
  âˆ€{i}{C : Prop i}
  {A : Set}{aâ‚š : in-Uâ‚š A}{A~ : A â†’ A â†’ Prop}{a~â‚š : in-U~â‚š A~}
  {B : A â†’ Set}{bâ‚š : (x : A) â†’ in-Uâ‚š (B x)}
  {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}{b~â‚š : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~â‚š (B~ xâ‚€â‚)} â†’
  ((a : in-Uâ‚œ aâ‚š)(a~ : in-U~â‚œ aâ‚š aâ‚š a~â‚š)(b : (x : A) â†’ in-Uâ‚œ (bâ‚š x))(b~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~â‚œ (bâ‚š xâ‚€) (bâ‚š xâ‚) (b~â‚š xâ‚€â‚)) â†’ C) â†’
  in-Uâ‚œ (Ï€â‚š aâ‚š a~â‚š bâ‚š b~â‚š) â†’ C
ind-in-Uâ‚œ f w = {!w!} -- f a a~ b b~  -- (Ï€â‚œ a a~ b b~)
-}




in-U : Set â†’ Setâ‚
in-U A = Î£sp (in-Uâ‚š A) in-Uâ‚œ

in-U~ : {Aâ‚€ Aâ‚ : Set}(aâ‚€ : in-U Aâ‚€)(aâ‚ : in-U Aâ‚)(Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop) â†’ Setâ‚
in-U~ {Aâ‚€}{Aâ‚}(aâ‚€â‚š ,sp aâ‚€)(aâ‚â‚š ,sp aâ‚) Aâ‚€â‚ = Î£sp (in-U~â‚š Aâ‚€â‚) (in-U~â‚œ aâ‚€â‚š aâ‚â‚š)

bool : in-U ğŸš
bool = boolâ‚š ,sp boolâ‚œ

Ï€ : {A : Set}(a : in-U A){A~ : A â†’ A â†’ Prop}(a~ : in-U~ a a A~)
    {B : A â†’ Set}(b : (x : A) â†’ in-U (B x))
    {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}
    (b~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~ (b xâ‚€) (b xâ‚) (B~ xâ‚€â‚)) â†’
    in-U (Î£sp ((x : A) â†’ B x) (Î» f â†’ (xâ‚€ xâ‚ : A)(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B~ xâ‚€â‚ (f xâ‚€) (f xâ‚)))
Ï€ {A}(aâ‚š ,sp a){A~}(a~â‚š ,sp a~){B} b {B~} b~ =
  Ï€â‚š aâ‚š a~â‚š (Î» x â†’ projâ‚sp (b x)) (Î» xâ‚€â‚ â†’ projâ‚sp (b~ xâ‚€â‚)) ,sp
  Ï€â‚œ a a~ (Î» x â†’ projâ‚‚sp (b x)) (Î» xâ‚€â‚ â†’ projâ‚‚sp (b~ xâ‚€â‚))

bool~ : in-U~ bool bool Î» xâ‚€ xâ‚ â†’ xâ‚€ â‰ŸğŸš xâ‚
bool~ = bool~â‚š ,sp bool~â‚œ

Ï€~ :
  {Aâ‚€ : Set}{aâ‚€ : in-U Aâ‚€}{Aâ‚€~ : Aâ‚€ â†’ Aâ‚€ â†’ Prop}{aâ‚€~ : in-U~ aâ‚€ aâ‚€ Aâ‚€~}
  {Aâ‚ : Set}{aâ‚ : in-U Aâ‚}{Aâ‚~ : Aâ‚ â†’ Aâ‚ â†’ Prop}{aâ‚~ : in-U~ aâ‚ aâ‚ Aâ‚~}
  {Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop}(aâ‚€â‚ : in-U~ aâ‚€ aâ‚ Aâ‚€â‚)
  {Bâ‚€ : Aâ‚€ â†’ Set}{bâ‚€ : (xâ‚€ : Aâ‚€) â†’ in-U (Bâ‚€ xâ‚€)}
    {Bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚€ xâ‚ â†’ Prop}
    {bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ in-U~ (bâ‚€ xâ‚€) (bâ‚€ xâ‚) (Bâ‚€~ xâ‚€â‚)}
  {Bâ‚ : Aâ‚ â†’ Set}{bâ‚ : (xâ‚ : Aâ‚) â†’ in-U (Bâ‚ xâ‚)}
    {Bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ Bâ‚ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
    {bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ in-U~ (bâ‚ xâ‚€) (bâ‚ xâ‚) (Bâ‚~ xâ‚€â‚)}
  {Bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
  (bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ in-U~ (bâ‚€ xâ‚€) (bâ‚ xâ‚) (Bâ‚€â‚ xâ‚€â‚)) â†’ 
  in-U~ (Ï€ aâ‚€ aâ‚€~ bâ‚€ {Bâ‚€~} bâ‚€~)
        (Ï€ aâ‚ aâ‚~ bâ‚ {Bâ‚~} bâ‚~)
        (Î» {(fâ‚€ ,sp fâ‚€~) (fâ‚ ,sp fâ‚~) â†’ (xâ‚€ : Aâ‚€)(xâ‚ : Aâ‚)(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ Bâ‚€â‚ xâ‚€â‚ (fâ‚€ xâ‚€) (fâ‚ xâ‚)})
Ï€~ {Aâ‚€}{aâ‚€â‚š ,sp aâ‚€}{Aâ‚€~}{aâ‚€~â‚š ,sp aâ‚€~}{Aâ‚}{aâ‚â‚š ,sp aâ‚}{Aâ‚~}{aâ‚~â‚š ,sp aâ‚~}{Aâ‚€â‚}(aâ‚€â‚â‚š ,sp aâ‚€â‚){Bâ‚€}{bâ‚€}{Bâ‚€~}{bâ‚€~}{Bâ‚}{bâ‚}{Bâ‚~}{bâ‚~}{Bâ‚€â‚} bâ‚€â‚ =
  Ï€~â‚š aâ‚€â‚š aâ‚€~â‚š aâ‚â‚š aâ‚~â‚š aâ‚€â‚â‚š (Î» x â†’ projâ‚sp (bâ‚€ x)) (Î» xâ‚€â‚ â†’ projâ‚sp (bâ‚€~ xâ‚€â‚)) (Î» x â†’ projâ‚sp (bâ‚ x)) (Î» xâ‚€â‚ â†’ projâ‚sp (bâ‚~ xâ‚€â‚)) (Î» xâ‚€â‚ â†’ projâ‚sp (bâ‚€â‚ xâ‚€â‚)) ,sp
  Ï€~â‚œ aâ‚€ aâ‚€~ aâ‚ aâ‚~ aâ‚€â‚ (Î» x â†’ projâ‚‚sp (bâ‚€ x)) (Î» xâ‚€â‚ â†’ projâ‚‚sp (bâ‚€~ xâ‚€â‚)) (Î» x â†’ projâ‚‚sp (bâ‚ x)) (Î» xâ‚€â‚ â†’ projâ‚‚sp (bâ‚~ xâ‚€â‚)) (Î» xâ‚€â‚ â†’ projâ‚‚sp (bâ‚€â‚ xâ‚€â‚))

-- simple eliminator targetting propositions

module _
  {i}
  {j}
  (in-Uá´° : âˆ€{A : Set} â†’ in-U A â†’ Prop i)
  (in-U~á´° : {Aâ‚€ Aâ‚ : Set}{aâ‚€ : in-U Aâ‚€}{aâ‚ : in-U Aâ‚}{Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop} â†’ in-U~ aâ‚€ aâ‚ Aâ‚€â‚ â†’ Prop j)
  (boolá´° : in-Uá´° bool)
  (Ï€á´° : {A : Set}{a : in-U A}(aá´° : in-Uá´° a){A~ : A â†’ A â†’ Prop}{a~ : in-U~ a a A~}(a~á´° : in-U~á´° {aâ‚€ = a}{aâ‚ = a} a~)
    {B : A â†’ Set}{b : (x : A) â†’ in-U (B x)}(bá´° : (x : A) â†’ in-Uá´° (b x))
    {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}
    {b~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~ (b xâ‚€) (b xâ‚) (B~ xâ‚€â‚)}
    (b~á´° : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~á´° {aâ‚€ = b xâ‚€}{aâ‚ = b xâ‚}(b~ xâ‚€â‚)) â†’ 
    in-Uá´° (Ï€ a a~ b b~))
  (bool~á´° : in-U~á´° {aâ‚€ = bool}{aâ‚ = bool} bool~)
  (Ï€~á´° : {Aâ‚€ : Set}{aâ‚€ : in-U Aâ‚€}(aâ‚€á´° : in-Uá´° aâ‚€){Aâ‚€~ : Aâ‚€ â†’ Aâ‚€ â†’ Prop}{aâ‚€~ : in-U~ aâ‚€ aâ‚€ Aâ‚€~}(aâ‚€~á´° : in-U~á´° {aâ‚€ = aâ‚€}{aâ‚ = aâ‚€} aâ‚€~)
    {Aâ‚ : Set}{aâ‚ : in-U Aâ‚}(aâ‚á´° : in-Uá´° aâ‚){Aâ‚~ : Aâ‚ â†’ Aâ‚ â†’ Prop}{aâ‚~ : in-U~ aâ‚ aâ‚ Aâ‚~}(aâ‚~á´° : in-U~á´° {aâ‚€ = aâ‚}{aâ‚ = aâ‚} aâ‚~)
    {Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop}{aâ‚€â‚ : in-U~ aâ‚€ aâ‚ Aâ‚€â‚}(aâ‚€â‚á´° : in-U~á´° {aâ‚€ = aâ‚€}{aâ‚ = aâ‚} aâ‚€â‚)
    {Bâ‚€ : Aâ‚€ â†’ Set}{bâ‚€ : (xâ‚€ : Aâ‚€) â†’ in-U (Bâ‚€ xâ‚€)}(bâ‚€á´° : (xâ‚€ : Aâ‚€) â†’ in-Uá´° (bâ‚€ xâ‚€))
      {Bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚€ xâ‚ â†’ Prop}
      {bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ in-U~ (bâ‚€ xâ‚€) (bâ‚€ xâ‚) (Bâ‚€~ xâ‚€â‚)}
      (bâ‚€~á´° : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ in-U~á´° {aâ‚€ = bâ‚€ xâ‚€}{aâ‚ = bâ‚€ xâ‚} (bâ‚€~ xâ‚€â‚))
    {Bâ‚ : Aâ‚ â†’ Set}{bâ‚ : (xâ‚ : Aâ‚) â†’ in-U (Bâ‚ xâ‚)}(bâ‚á´° : (xâ‚ : Aâ‚) â†’ in-Uá´° (bâ‚ xâ‚))
      {Bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ Bâ‚ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
      {bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ in-U~ (bâ‚ xâ‚€) (bâ‚ xâ‚) (Bâ‚~ xâ‚€â‚)}
      (bâ‚~á´° : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ in-U~á´° {aâ‚€ = bâ‚ xâ‚€}{aâ‚ = bâ‚ xâ‚} (bâ‚~ xâ‚€â‚))
    {Bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
    {bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ in-U~ (bâ‚€ xâ‚€) (bâ‚ xâ‚) (Bâ‚€â‚ xâ‚€â‚)}
    (bâ‚€â‚á´° : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ in-U~á´° {aâ‚€ = bâ‚€ xâ‚€}{aâ‚ = bâ‚ xâ‚} (bâ‚€â‚ xâ‚€â‚)) â†’ 
    in-U~á´° {aâ‚€ = Ï€ aâ‚€ aâ‚€~ bâ‚€ bâ‚€~}{aâ‚ = Ï€ aâ‚ aâ‚~ bâ‚ bâ‚~} (Ï€~ {aâ‚€ = aâ‚€}{aâ‚€~ = aâ‚€~}{aâ‚ = aâ‚}{aâ‚~ = aâ‚~} aâ‚€â‚ {bâ‚€ = bâ‚€}{bâ‚€~ = bâ‚€~}{bâ‚ = bâ‚}{bâ‚~ = bâ‚~} bâ‚€â‚))
  where

  ind-in-U : âˆ€{A : Set}(a : in-U A) â†’ in-Uá´° a
  ind-in-U~ : âˆ€{Aâ‚€ Aâ‚ : Set}{aâ‚€ : in-U Aâ‚€}{aâ‚ : in-U Aâ‚}{Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop}(aâ‚€â‚ : in-U~ aâ‚€ aâ‚ Aâ‚€â‚) â†’ in-U~á´° {aâ‚€ = aâ‚€}{aâ‚ = aâ‚} aâ‚€â‚
  
  ind-in-U (boolâ‚š ,sp _) = boolá´°
  ind-in-U (Ï€â‚š {A} aâ‚š {A~} a~â‚š {B} bâ‚š {B~} b~â‚š ,sp Ï€â‚œ a a~ b b~) =
    Ï€á´° (ind-in-U (aâ‚š ,sp a)) (ind-in-U~ (a~â‚š ,sp a~)) (Î» x â†’ ind-in-U (bâ‚š x ,sp b x)) (Î» xâ‚€â‚ â†’ ind-in-U~ (b~â‚š xâ‚€â‚ ,sp b~ xâ‚€â‚))

  ind-in-U~ (bool~â‚š ,sp bool~â‚œ) = bool~á´°
  ind-in-U~ (Ï€~â‚š aâ‚€â‚š aâ‚€~â‚š aâ‚â‚š aâ‚~â‚š aâ‚€â‚â‚š bâ‚€â‚š bâ‚€~â‚š bâ‚â‚š bâ‚~â‚š bâ‚€â‚â‚š ,sp Ï€~â‚œ aâ‚€ aâ‚€~ aâ‚ aâ‚~ aâ‚€â‚ bâ‚€ bâ‚€~ bâ‚ bâ‚~ bâ‚€â‚) =
    Ï€~á´° (ind-in-U (aâ‚€â‚š ,sp aâ‚€)) (ind-in-U~ (aâ‚€~â‚š ,sp aâ‚€~)) (ind-in-U (aâ‚â‚š ,sp aâ‚)) (ind-in-U~ (aâ‚~â‚š ,sp aâ‚~)) (ind-in-U~ (aâ‚€â‚â‚š ,sp aâ‚€â‚))
    (Î» x â†’ ind-in-U (bâ‚€â‚š x ,sp bâ‚€ x)) (Î» xâ‚€â‚ â†’ ind-in-U~ (bâ‚€~â‚š xâ‚€â‚ ,sp bâ‚€~ xâ‚€â‚)) (Î» x â†’ ind-in-U (bâ‚â‚š x ,sp bâ‚ x)) (Î» xâ‚€â‚ â†’ ind-in-U~ (bâ‚~â‚š xâ‚€â‚ ,sp bâ‚~ xâ‚€â‚))
    Î» xâ‚€â‚ â†’ ind-in-U~ (bâ‚€â‚â‚š xâ‚€â‚ ,sp bâ‚€â‚ xâ‚€â‚)

-- simple eliminator targetting sets

open import Agda.Builtin.Equality

withProp : âˆ€{i j} {P : Prop i} {Q : Prop j} -> P -> (P -> Q) -> Q
withProp p f = f p

postulate
  _â‰¡p_ : âˆ€{i} {A : Set i} -> A -> A -> Prop i
  reflp : âˆ€{i} {A : Set i} {a : A} -> a â‰¡p a
  to-â‰¡ : âˆ€{i} {A : Set i} {x y : A} -> x â‰¡p y -> x â‰¡ y

module _
  {i}
  {j}
  (in-Uá´° : âˆ€{A : Set} â†’ in-U A â†’ Set i)
  (in-U~á´° : {Aâ‚€ Aâ‚ : Set}{aâ‚€ : in-U Aâ‚€}{aâ‚ : in-U Aâ‚}{Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop} â†’ in-U~ aâ‚€ aâ‚ Aâ‚€â‚ â†’ Set j)
  (boolá´° : in-Uá´° bool)
  (Ï€á´° : {A : Set}{a : in-U A}(aá´° : in-Uá´° a){A~ : A â†’ A â†’ Prop}{a~ : in-U~ a a A~}(a~á´° : in-U~á´° {aâ‚€ = a}{aâ‚ = a} a~)
    {B : A â†’ Set}{b : (x : A) â†’ in-U (B x)}(bá´° : (x : A) â†’ in-Uá´° (b x))
    {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}
    {b~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~ (b xâ‚€) (b xâ‚) (B~ xâ‚€â‚)}
    (b~á´° : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~á´° {aâ‚€ = b xâ‚€}{aâ‚ = b xâ‚}(b~ xâ‚€â‚)) â†’ 
    in-Uá´° (Ï€ a a~ b b~))
  (bool~á´° : in-U~á´° {aâ‚€ = bool}{aâ‚ = bool} bool~)
  (Ï€~á´° : {Aâ‚€ : Set}{aâ‚€ : in-U Aâ‚€}(aâ‚€á´° : in-Uá´° aâ‚€){Aâ‚€~ : Aâ‚€ â†’ Aâ‚€ â†’ Prop}{aâ‚€~ : in-U~ aâ‚€ aâ‚€ Aâ‚€~}(aâ‚€~á´° : in-U~á´° {aâ‚€ = aâ‚€}{aâ‚ = aâ‚€} aâ‚€~)
    {Aâ‚ : Set}{aâ‚ : in-U Aâ‚}(aâ‚á´° : in-Uá´° aâ‚){Aâ‚~ : Aâ‚ â†’ Aâ‚ â†’ Prop}{aâ‚~ : in-U~ aâ‚ aâ‚ Aâ‚~}(aâ‚~á´° : in-U~á´° {aâ‚€ = aâ‚}{aâ‚ = aâ‚} aâ‚~)
    {Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop}{aâ‚€â‚ : in-U~ aâ‚€ aâ‚ Aâ‚€â‚}(aâ‚€â‚á´° : in-U~á´° {aâ‚€ = aâ‚€}{aâ‚ = aâ‚} aâ‚€â‚)
    {Bâ‚€ : Aâ‚€ â†’ Set}{bâ‚€ : (xâ‚€ : Aâ‚€) â†’ in-U (Bâ‚€ xâ‚€)}(bâ‚€á´° : (xâ‚€ : Aâ‚€) â†’ in-Uá´° (bâ‚€ xâ‚€))
      {Bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚€ xâ‚ â†’ Prop}
      {bâ‚€~ : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ in-U~ (bâ‚€ xâ‚€) (bâ‚€ xâ‚) (Bâ‚€~ xâ‚€â‚)}
      (bâ‚€~á´° : {xâ‚€ xâ‚ : Aâ‚€}(xâ‚€â‚ : Aâ‚€~ xâ‚€ xâ‚) â†’ in-U~á´° {aâ‚€ = bâ‚€ xâ‚€}{aâ‚ = bâ‚€ xâ‚} (bâ‚€~ xâ‚€â‚))
    {Bâ‚ : Aâ‚ â†’ Set}{bâ‚ : (xâ‚ : Aâ‚) â†’ in-U (Bâ‚ xâ‚)}(bâ‚á´° : (xâ‚ : Aâ‚) â†’ in-Uá´° (bâ‚ xâ‚))
      {Bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ Bâ‚ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
      {bâ‚~ : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ in-U~ (bâ‚ xâ‚€) (bâ‚ xâ‚) (Bâ‚~ xâ‚€â‚)}
      (bâ‚~á´° : {xâ‚€ xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚~ xâ‚€ xâ‚) â†’ in-U~á´° {aâ‚€ = bâ‚ xâ‚€}{aâ‚ = bâ‚ xâ‚} (bâ‚~ xâ‚€â‚))
    {Bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ Bâ‚€ xâ‚€ â†’ Bâ‚ xâ‚ â†’ Prop}
    {bâ‚€â‚ : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ in-U~ (bâ‚€ xâ‚€) (bâ‚ xâ‚) (Bâ‚€â‚ xâ‚€â‚)}
    (bâ‚€â‚á´° : {xâ‚€ : Aâ‚€}{xâ‚ : Aâ‚}(xâ‚€â‚ : Aâ‚€â‚ xâ‚€ xâ‚) â†’ in-U~á´° {aâ‚€ = bâ‚€ xâ‚€}{aâ‚ = bâ‚ xâ‚} (bâ‚€â‚ xâ‚€â‚)) â†’ 
    in-U~á´° {aâ‚€ = Ï€ aâ‚€ aâ‚€~ bâ‚€ bâ‚€~}{aâ‚ = Ï€ aâ‚ aâ‚~ bâ‚ bâ‚~} (Ï€~ {aâ‚€ = aâ‚€}{aâ‚€~ = aâ‚€~}{aâ‚ = aâ‚}{aâ‚~ = aâ‚~} aâ‚€â‚ {bâ‚€ = bâ‚€}{bâ‚€~ = bâ‚€~}{bâ‚ = bâ‚}{bâ‚~ = bâ‚~} bâ‚€â‚))
  where

  ind-in-U' : {A : Set} (aâ‚š : in-Uâ‚š A) (aâ‚œ : in-Uâ‚œ aâ‚š) -> in-Uá´° (aâ‚š ,sp aâ‚œ)
  ind-in-U~' : {Aâ‚€ Aâ‚ : Set} {Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop} {aâ‚€ : in-U Aâ‚€}{aâ‚ : in-U Aâ‚}
               (aâ‚€â‚â‚š : in-U~â‚š Aâ‚€â‚)
               (aâ‚€â‚â‚œ : in-U~â‚œ (projâ‚sp aâ‚€) (projâ‚sp aâ‚) aâ‚€â‚â‚š)
             â†’ in-U~á´° {aâ‚€ = aâ‚€}{aâ‚ = aâ‚} (aâ‚€â‚â‚š ,sp aâ‚€â‚â‚œ)

  ind-in-U' boolâ‚š y = boolá´°
  ind-in-U' (Ï€â‚š {A} aâ‚š {A~} a~â‚š {B} bâ‚š {B~} b~â‚š) w =
    Ï€á´° (ind-in-U' aâ‚š a)
       (ind-in-U~' a~â‚š a~)
       (Î» x â†’ ind-in-U' (bâ‚š x) (b x))
       (Î» xâ‚€â‚ â†’ ind-in-U~' (b~â‚š xâ‚€â‚) (b~ xâ‚€â‚))
    where
      a : in-Uâ‚œ aâ‚š
      a = withProp w (Î» { (Ï€â‚œ x _ _ _) â†’ x })
      a~ : in-U~â‚œ aâ‚š aâ‚š a~â‚š
      a~ = withProp w (Î» { (Ï€â‚œ _ x _ _) â†’ x })
      b : (x : _) -> in-Uâ‚œ (bâ‚š x)
      b x = withProp w (Î» { (Ï€â‚œ _ _ y _) â†’ y x })
      b~ : {xâ‚€ xâ‚ : _} (xâ‚€â‚ : _) -> in-U~â‚œ (bâ‚š xâ‚€) (bâ‚š xâ‚) (b~â‚š xâ‚€â‚)
      b~ = withProp w Î» { (Ï€â‚œ _ _ _ b~) â†’ b~ }

  ind-in-U~' {aâ‚€ = aâ‚€} {aâ‚} bool~â‚š y =
    goal (to-â‰¡ (withProp y (Î» { bool~â‚œ â†’ reflp }))) (to-â‰¡ (withProp y (Î» { bool~â‚œ â†’ reflp })))
    where
      goal : aâ‚€ â‰¡ bool -> aâ‚ â‰¡ bool -> _
      goal refl refl = bool~á´°
  ind-in-U~' {aâ‚€ = xâ‚€} {xâ‚} (Ï€~â‚š aâ‚€â‚š aâ‚€~â‚š aâ‚â‚š aâ‚~â‚š aâ‚€â‚â‚š bâ‚€â‚š bâ‚€~â‚š bâ‚â‚š bâ‚~â‚š bâ‚€â‚â‚š) p =
    goal (to-â‰¡ (withProp p Î» { (Ï€~â‚œ _ _ _ _ _ _ _ _ _ _) â†’ reflp }))
         (to-â‰¡ (withProp p Î» { (Ï€~â‚œ _ _ _ _ _ _ _ _ _ _) â†’ reflp }))
    where
      aâ‚€â‚œ = withProp p Î» { (Ï€~â‚œ x _ _ _ _ _ _ _ _ _) â†’ x }
      aâ‚€~â‚œ = withProp p Î» { (Ï€~â‚œ _ x _ _ _ _ _ _ _ _) â†’ x }
      bâ‚€â‚œ : (x : _) -> in-Uâ‚œ (bâ‚€â‚š x)
      bâ‚€â‚œ = withProp p Î» { (Ï€~â‚œ _ _ _ _ _ x _ _ _ _) â†’ x }
      bâ‚€~â‚œ : {xâ‚€ xâ‚ : _} (xâ‚€â‚ : _) -> in-U~â‚œ (bâ‚€â‚š xâ‚€) (bâ‚€â‚š xâ‚) (bâ‚€~â‚š xâ‚€â‚)
      bâ‚€~â‚œ = withProp p Î» { (Ï€~â‚œ _ _ _ _ _ _ x _ _ _) â†’ x }
      aâ‚â‚œ = withProp p Î» { (Ï€~â‚œ _ _ x _ _ _ _ _ _ _) â†’ x }
      aâ‚~â‚œ = withProp p Î» { (Ï€~â‚œ _ _ _ x _ _ _ _ _ _) â†’ x }
      bâ‚â‚œ : (x : _) -> in-Uâ‚œ (bâ‚â‚š x)
      bâ‚â‚œ = withProp p Î» { (Ï€~â‚œ _ _ _ _ _ _ _ x _ _) â†’ x }
      bâ‚~â‚œ : {xâ‚€ xâ‚ : _} (xâ‚€â‚ : _) -> in-U~â‚œ (bâ‚â‚š xâ‚€) (bâ‚â‚š xâ‚) (bâ‚~â‚š xâ‚€â‚)
      bâ‚~â‚œ = withProp p Î» { (Ï€~â‚œ _ _ _ _ _ _ _ _ x _) â†’ x }
      aâ‚€â‚â‚œ : in-U~â‚œ aâ‚€â‚š aâ‚â‚š aâ‚€â‚â‚š
      aâ‚€â‚â‚œ = withProp p Î» { (Ï€~â‚œ _ _ _ _ x _ _ _ _ _) â†’ x }
      bâ‚€â‚â‚œ : {xâ‚€ : _} {xâ‚ : _} (xâ‚€â‚ : _) -> in-U~â‚œ (bâ‚€â‚š xâ‚€) (bâ‚â‚š xâ‚) (bâ‚€â‚â‚š xâ‚€â‚)
      bâ‚€â‚â‚œ = withProp p Î» { (Ï€~â‚œ _ _ _ _ _ _ _ _ _ x) â†’ x }

      goal : xâ‚€ â‰¡ Ï€ (aâ‚€â‚š ,sp aâ‚€â‚œ) (aâ‚€~â‚š ,sp aâ‚€~â‚œ) (Î» x â†’ bâ‚€â‚š x ,sp bâ‚€â‚œ x) (Î» xâ‚€â‚ â†’ bâ‚€~â‚š xâ‚€â‚ ,sp bâ‚€~â‚œ xâ‚€â‚)
           â†’ xâ‚ â‰¡ Ï€ (aâ‚â‚š ,sp aâ‚â‚œ) (aâ‚~â‚š ,sp aâ‚~â‚œ) (Î» x â†’ bâ‚â‚š x ,sp bâ‚â‚œ x) (Î» xâ‚€â‚ â†’ bâ‚~â‚š xâ‚€â‚ ,sp bâ‚~â‚œ xâ‚€â‚)
           â†’ _
      goal refl refl =
        Ï€~á´° (ind-in-U' aâ‚€â‚š aâ‚€â‚œ)
            (ind-in-U~' aâ‚€~â‚š aâ‚€~â‚œ)
            (ind-in-U' aâ‚â‚š aâ‚â‚œ)
            (ind-in-U~' aâ‚~â‚š aâ‚~â‚œ)
            (ind-in-U~' aâ‚€â‚â‚š aâ‚€â‚â‚œ)
            (Î» x â†’ ind-in-U' (bâ‚€â‚š x) (bâ‚€â‚œ x))
            (Î» xâ‚€â‚ â†’ ind-in-U~' (bâ‚€~â‚š xâ‚€â‚) (bâ‚€~â‚œ xâ‚€â‚))
            (Î» x â†’ ind-in-U' (bâ‚â‚š x) (bâ‚â‚œ x))
            (Î» xâ‚€â‚ â†’ ind-in-U~' (bâ‚~â‚š xâ‚€â‚) (bâ‚~â‚œ xâ‚€â‚))
            (Î» xâ‚€â‚ â†’ ind-in-U~' (bâ‚€â‚â‚š xâ‚€â‚) (bâ‚€â‚â‚œ xâ‚€â‚))

  ind-in-U-Set : âˆ€{A : Set}(a : in-U A) â†’ in-Uá´° a
  ind-in-U-Set (a ,sp a') = ind-in-U' a a'

  ind-in-U~-Set : âˆ€{Aâ‚€ Aâ‚ : Set}{aâ‚€ : in-U Aâ‚€}{aâ‚ : in-U Aâ‚}{Aâ‚€â‚ : Aâ‚€ â†’ Aâ‚ â†’ Prop}
               (aâ‚€â‚ : in-U~ aâ‚€ aâ‚ Aâ‚€â‚) â†’ in-U~á´° {aâ‚€ = aâ‚€}{aâ‚ = aâ‚} aâ‚€â‚
  ind-in-U~-Set (a ,sp a') = ind-in-U~' a a'

module double
  {i}
  (in-Uá´° : âˆ€{Aâ° AÂ¹ : Set} â†’ in-U Aâ° â†’ in-U AÂ¹ â†’ Set i)
  (boolboolá´° : in-Uá´° bool bool)
  (boolÏ€á´° : {A : Set}(a : in-U A){A~ : A â†’ A â†’ Prop}(a~ : in-U~ a a A~)
    {B : A â†’ Set}(b : (x : A) â†’ in-U (B x))
    {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}
    (b~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~ (b xâ‚€) (b xâ‚) (B~ xâ‚€â‚)) â†’  in-Uá´° bool (Ï€ a a~ b b~))
  (Ï€boolá´° : {A : Set}(a : in-U A){A~ : A â†’ A â†’ Prop}(a~ : in-U~ a a A~)
    {B : A â†’ Set}(b : (x : A) â†’ in-U (B x))
    {B~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ B xâ‚€ â†’ B xâ‚ â†’ Prop}
    (b~ : {xâ‚€ xâ‚ : A}(xâ‚€â‚ : A~ xâ‚€ xâ‚) â†’ in-U~ (b xâ‚€) (b xâ‚) (B~ xâ‚€â‚)) â†’  in-Uá´° (Ï€ a a~ b b~) bool)
  (Ï€Ï€á´° : {Aâ° : Set}{AÂ¹ : Set}{aâ° : in-U Aâ°}{aÂ¹ : in-U AÂ¹}(aá´° : in-Uá´° aâ° aÂ¹)
    {A~â° : Aâ° â†’ Aâ° â†’ Prop}{A~Â¹ : AÂ¹ â†’ AÂ¹ â†’ Prop}(a~â° : in-U~ aâ° aâ° A~â°)(a~Â¹ : in-U~ aÂ¹ aÂ¹ A~Â¹)
    {Bâ° : Aâ° â†’ Set}{BÂ¹ : AÂ¹ â†’ Set}{bâ° : (x : Aâ°) â†’ in-U (Bâ° x)}{bÂ¹ : (x : AÂ¹) â†’ in-U (BÂ¹ x)}(bá´° : (xâ° : Aâ°)(xÂ¹ : AÂ¹) â†’ in-Uá´° (bâ° xâ°) (bÂ¹ xÂ¹))
    {B~â° : {xâ‚€ xâ‚ : Aâ°}(xâ‚€â‚ : A~â° xâ‚€ xâ‚) â†’ Bâ° xâ‚€ â†’ Bâ° xâ‚ â†’ Prop}{B~Â¹ : {xâ‚€ xâ‚ : AÂ¹}(xâ‚€â‚ : A~Â¹ xâ‚€ xâ‚) â†’ BÂ¹ xâ‚€ â†’ BÂ¹ xâ‚ â†’ Prop}
    (b~â° : {xâ‚€ xâ‚ : Aâ°}(xâ‚€â‚ : A~â° xâ‚€ xâ‚) â†’ in-U~ (bâ° xâ‚€) (bâ° xâ‚) (B~â° xâ‚€â‚))(b~Â¹ : {xâ‚€ xâ‚ : AÂ¹}(xâ‚€â‚ : A~Â¹ xâ‚€ xâ‚) â†’ in-U~ (bÂ¹ xâ‚€) (bÂ¹ xâ‚) (B~Â¹ xâ‚€â‚)) â†’ 
    in-Uá´° (Ï€ aâ° a~â° bâ° b~â°) (Ï€ aÂ¹ a~Â¹ bÂ¹ b~Â¹))
  where
  ind-in-U'' : âˆ€{Aâ° : Set}(aâ° : in-U Aâ°){AÂ¹ : Set}(aÂ¹ : in-U AÂ¹) â†’ in-Uá´° aâ° aÂ¹
  ind-in-U'' = ind-in-U-Set (Î» aâ° â†’ âˆ€{AÂ¹}(aÂ¹ : in-U AÂ¹) â†’ in-Uá´° aâ° aÂ¹) (Î» _ â†’ âŠ¤)
    (ind-in-U-Set (Î» aÂ¹ â†’ in-Uá´° bool aÂ¹) (Î» _ â†’ âŠ¤) boolboolá´° (Î» {A}{a} _ {A~}{a~} _ {B}{b} _ {B~}{b~} _ â†’ boolÏ€á´° a a~ b b~) tt (Î» _ _ _ _ _ _ _ _ _ _ â†’ tt))
    (Î» {Aâ°}{aâ°} aá´°' {A~â°}{a~â°} _ {Bâ°}{bâ°} bá´°' {B~â°}{b~â°} _ â†’ ind-in-U-Set
      (Î» cÂ¹ â†’ in-Uá´° (Ï€ aâ° a~â° bâ° b~â°) cÂ¹) (Î» _ â†’ âŠ¤)
      (Ï€boolá´° aâ° a~â° bâ° b~â°)
      (Î» {AÂ¹}{aÂ¹} aá´° {A~Â¹}{a~Â¹} _ {BÂ¹}{bÂ¹} bá´° {B~Â¹}{b~Â¹} _ â†’ Ï€Ï€á´° {aâ° = aâ°}{aÂ¹} (aá´°' aÂ¹) a~â° a~Â¹ {bâ° = bâ°}{bÂ¹} (Î» xâ° xÂ¹ â†’ bá´°' xâ° (bÂ¹ xÂ¹)) b~â° b~Â¹)
      tt Î» _ _ _ _ _ _ _ _ _ _ â†’ tt)
    tt (Î» _ _ _ _ _ _ _ _ _ _ â†’ tt)
