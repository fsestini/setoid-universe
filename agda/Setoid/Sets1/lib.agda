{-# OPTIONS --without-K --prop #-}

module Setoid.Sets1.lib where

open import Setoid.lib

-- Sets1

data in-U‚Çö : Set ‚Üí Set‚ÇÅ
data in-U~‚Çö : {A‚ÇÄ A‚ÇÅ : Set}(A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop) ‚Üí Set‚ÇÅ

data in-U‚Çö where
  bool‚Çö : in-U‚Çö ùüö
  œÄ‚Çö :
    {A : Set}(a‚Çö : in-U‚Çö A){A~ : A ‚Üí A ‚Üí Prop}(a~‚Çö : in-U~‚Çö A~)
    {B : A ‚Üí Set}(b‚Çö : (x : A) ‚Üí in-U‚Çö (B x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    (b~‚Çö : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B~ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U‚Çö (Œ£sp ((x : A) ‚Üí B x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A)(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B~ x‚ÇÄ‚ÇÅ (f x‚ÇÄ) (f x‚ÇÅ)))

data in-U~‚Çö where
  bool~‚Çö : in-U~‚Çö Œª x‚ÇÄ x‚ÇÅ ‚Üí if x‚ÇÄ then (if x‚ÇÅ then ‚ä§p else ‚ä•p) else (if x‚ÇÅ then ‚ä•p else ‚ä§p)
  œÄ~‚Çö :
    {A‚ÇÄ : Set}(a‚ÇÄ : in-U‚Çö A‚ÇÄ){A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}(a‚ÇÄ~ : in-U~‚Çö A‚ÇÄ~)
    {A‚ÇÅ : Set}(a‚ÇÅ : in-U‚Çö A‚ÇÅ){A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÅ~ : in-U~‚Çö A‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~‚Çö A‚ÇÄ‚ÇÅ)

    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}(b‚ÇÄ : (x : A‚ÇÄ) ‚Üí in-U‚Çö (B‚ÇÄ x))
      {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
      (b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}(b‚ÇÅ : (x : A‚ÇÅ) ‚Üí in-U‚Çö (B‚ÇÅ x))
      {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
      (b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    (b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
     
    in-U~‚Çö
      {Œ£sp ((x : A‚ÇÄ) ‚Üí B‚ÇÄ x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A‚ÇÄ)(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ~ x‚ÇÄ‚ÇÅ (f x‚ÇÄ) (f x‚ÇÅ))}
      {Œ£sp ((x : A‚ÇÅ) ‚Üí B‚ÇÅ x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ~ x‚ÇÄ‚ÇÅ (f x‚ÇÄ) (f x‚ÇÅ))}
      (Œª {(f‚ÇÄ ,sp f‚ÇÄ~) (f‚ÇÅ ,sp f‚ÇÅ~) ‚Üí (x‚ÇÄ : A‚ÇÄ)(x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ (f‚ÇÄ x‚ÇÄ) (f‚ÇÅ x‚ÇÅ)})

data in-U‚Çú : {A : Set} ‚Üí in-U‚Çö A ‚Üí Prop‚ÇÅ
data in-U~‚Çú : {A‚ÇÄ A‚ÇÅ : Set}(a‚ÇÄ : in-U‚Çö A‚ÇÄ)(a‚ÇÅ : in-U‚Çö A‚ÇÅ){A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~‚Çö A‚ÇÄ‚ÇÅ ‚Üí Prop‚ÇÅ

data in-U‚Çú where
  bool‚Çú : in-U‚Çú bool‚Çö
  œÄ‚Çú :
    {A : Set}{a‚Çö : in-U‚Çö A}(a : in-U‚Çú a‚Çö){A~ : A ‚Üí A ‚Üí Prop}{a~‚Çö : in-U~‚Çö A~}(a~ : in-U~‚Çú a‚Çö a‚Çö a~‚Çö)
    {B : A ‚Üí Set}{b‚Çö : (x : A) ‚Üí in-U‚Çö (B x)}(b : (x : A) ‚Üí in-U‚Çú (b‚Çö x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    {b~‚Çö : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B~ x‚ÇÄ‚ÇÅ)} ‚Üí
    (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çú (b‚Çö x‚ÇÄ) (b‚Çö x‚ÇÅ) (b~‚Çö x‚ÇÄ‚ÇÅ)) ‚Üí
    in-U‚Çú (œÄ‚Çö a‚Çö a~‚Çö b‚Çö b~‚Çö)

data in-U~‚Çú where
  bool~‚Çú : in-U~‚Çú bool‚Çö bool‚Çö bool~‚Çö
  œÄ~‚Çú :
    {A‚ÇÄ : Set}{a‚ÇÄ‚Çö : in-U‚Çö A‚ÇÄ}(a‚ÇÄ : in-U‚Çú a‚ÇÄ‚Çö){A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~‚Çö : in-U~‚Çö A‚ÇÄ~}(a‚ÇÄ~ : in-U~‚Çú a‚ÇÄ‚Çö a‚ÇÄ‚Çö a‚ÇÄ~‚Çö)
    {A‚ÇÅ : Set}{a‚ÇÅ‚Çö : in-U‚Çö A‚ÇÅ}(a‚ÇÅ : in-U‚Çú a‚ÇÅ‚Çö){A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~‚Çö : in-U~‚Çö A‚ÇÅ~}(a‚ÇÅ~ : in-U~‚Çú a‚ÇÅ‚Çö a‚ÇÅ‚Çö a‚ÇÅ~‚Çö)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ‚Çö : in-U~‚Çö A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ : in-U~‚Çú a‚ÇÄ‚Çö a‚ÇÅ‚Çö a‚ÇÄ‚ÇÅ‚Çö)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ‚Çö : (x : A‚ÇÄ) ‚Üí in-U‚Çö (B‚ÇÄ x)}(b‚ÇÄ : (x : A‚ÇÄ) ‚Üí in-U‚Çú (b‚ÇÄ‚Çö x))
    {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ~‚Çö : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çú (b‚ÇÄ‚Çö x‚ÇÄ) (b‚ÇÄ‚Çö x‚ÇÅ) (b‚ÇÄ~‚Çö x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ‚Çö : (x : A‚ÇÅ) ‚Üí in-U‚Çö (B‚ÇÅ x)}(b‚ÇÅ : (x : A‚ÇÅ) ‚Üí in-U‚Çú (b‚ÇÅ‚Çö x))
    {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÅ~‚Çö : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çú (b‚ÇÅ‚Çö x‚ÇÄ) (b‚ÇÅ‚Çö x‚ÇÅ) (b‚ÇÅ~‚Çö x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ‚Çö : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö  (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çú (b‚ÇÄ‚Çö x‚ÇÄ) (b‚ÇÅ‚Çö x‚ÇÅ) (b‚ÇÄ‚ÇÅ‚Çö x‚ÇÄ‚ÇÅ)) ‚Üí
    in-U~‚Çú (œÄ‚Çö a‚ÇÄ‚Çö a‚ÇÄ~‚Çö b‚ÇÄ‚Çö b‚ÇÄ~‚Çö) (œÄ‚Çö a‚ÇÅ‚Çö a‚ÇÅ~‚Çö b‚ÇÅ‚Çö b‚ÇÅ~‚Çö)
      (œÄ~‚Çö a‚ÇÄ‚Çö a‚ÇÄ~‚Çö a‚ÇÅ‚Çö a‚ÇÅ~‚Çö a‚ÇÄ‚ÇÅ‚Çö b‚ÇÄ‚Çö b‚ÇÄ~‚Çö b‚ÇÅ‚Çö b‚ÇÅ~‚Çö b‚ÇÄ‚ÇÅ‚Çö)
{-
proj‚ÇÅ-in-U‚Çú-œÄ :
  {A : Set}{a‚Çö : in-U‚Çö A}{A~ : A ‚Üí A ‚Üí Prop}{a~‚Çö : in-U~‚Çö A~}
  {B : A ‚Üí Set}{b‚Çö : (x : A) ‚Üí in-U‚Çö (B x)}
  {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
  {b~‚Çö : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B~ x‚ÇÄ‚ÇÅ)}
  {C : Set}{c‚Çö : in-U‚Çö C}(c‚Çú : in-U‚Çú c‚Çö)
  (e : C ‚â° (Œ£sp ((x : A) ‚Üí B x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A)(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B~ x‚ÇÄ‚ÇÅ (f x‚ÇÄ) (f x‚ÇÅ))))
  (e' : transport in-U‚Çö e c‚Çö ‚â° œÄ‚Çö a‚Çö a~‚Çö b‚Çö b~‚Çö) ‚Üí
  in-U‚Çú a‚Çö
proj‚ÇÅ-in-U‚Çú-œÄ bool‚Çú e e' = {!c!}
proj‚ÇÅ-in-U‚Çú-œÄ (œÄ‚Çú a a~ b b~) e e' = {!!}
-}
{-
ind-in-U‚Çú :
  ‚àÄ{i}{C : Prop i}
  {A : Set}{a‚Çö : in-U‚Çö A}{A~ : A ‚Üí A ‚Üí Prop}{a~‚Çö : in-U~‚Çö A~}
  {B : A ‚Üí Set}{b‚Çö : (x : A) ‚Üí in-U‚Çö (B x)}
  {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}{b~‚Çö : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B~ x‚ÇÄ‚ÇÅ)} ‚Üí
  ((a : in-U‚Çú a‚Çö)(a~ : in-U~‚Çú a‚Çö a‚Çö a~‚Çö)(b : (x : A) ‚Üí in-U‚Çú (b‚Çö x))(b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çú (b‚Çö x‚ÇÄ) (b‚Çö x‚ÇÅ) (b~‚Çö x‚ÇÄ‚ÇÅ)) ‚Üí C) ‚Üí
  in-U‚Çú (œÄ‚Çö a‚Çö a~‚Çö b‚Çö b~‚Çö) ‚Üí C
ind-in-U‚Çú f w = {!w!} -- f a a~ b b~  -- (œÄ‚Çú a a~ b b~)
-}




in-U : Set ‚Üí Set‚ÇÅ
in-U A = Œ£sp (in-U‚Çö A) in-U‚Çú

in-U~ : {A‚ÇÄ A‚ÇÅ : Set}(a‚ÇÄ : in-U A‚ÇÄ)(a‚ÇÅ : in-U A‚ÇÅ)(A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop) ‚Üí Set‚ÇÅ
in-U~ {A‚ÇÄ}{A‚ÇÅ}(a‚ÇÄ‚Çö ,sp a‚ÇÄ)(a‚ÇÅ‚Çö ,sp a‚ÇÅ) A‚ÇÄ‚ÇÅ = Œ£sp (in-U~‚Çö A‚ÇÄ‚ÇÅ) (in-U~‚Çú a‚ÇÄ‚Çö a‚ÇÅ‚Çö)

bool : in-U ùüö
bool = bool‚Çö ,sp bool‚Çú

œÄ : {A : Set}(a : in-U A){A~ : A ‚Üí A ‚Üí Prop}(a~ : in-U~ a a A~)
    {B : A ‚Üí Set}(b : (x : A) ‚Üí in-U (B x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    (b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)) ‚Üí
    in-U (Œ£sp ((x : A) ‚Üí B x) (Œª f ‚Üí (x‚ÇÄ x‚ÇÅ : A)(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B~ x‚ÇÄ‚ÇÅ (f x‚ÇÄ) (f x‚ÇÅ)))
œÄ {A}(a‚Çö ,sp a){A~}(a~‚Çö ,sp a~){B} b {B~} b~ =
  œÄ‚Çö a‚Çö a~‚Çö (Œª x ‚Üí proj‚ÇÅsp (b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÅsp (b~ x‚ÇÄ‚ÇÅ)) ,sp
  œÄ‚Çú a a~ (Œª x ‚Üí proj‚ÇÇsp (b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÇsp (b~ x‚ÇÄ‚ÇÅ))

bool~ : in-U~ bool bool Œª x‚ÇÄ x‚ÇÅ ‚Üí if x‚ÇÄ then (if x‚ÇÅ then ‚ä§p else ‚ä•p) else (if x‚ÇÅ then ‚ä•p else ‚ä§p)
bool~ = bool~‚Çö ,sp bool~‚Çú

œÄ~ :
  {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}
  {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}
  {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ)
  {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}
    {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
  {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}
    {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
  {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
  (b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
  in-U~ (œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ {B‚ÇÄ~} b‚ÇÄ~)
        (œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ {B‚ÇÅ~} b‚ÇÅ~)
        (Œª {(f‚ÇÄ ,sp f‚ÇÄ~) (f‚ÇÅ ,sp f‚ÇÅ~) ‚Üí (x‚ÇÄ : A‚ÇÄ)(x‚ÇÅ : A‚ÇÅ)(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ (f‚ÇÄ x‚ÇÄ) (f‚ÇÅ x‚ÇÅ)})
œÄ~ {A‚ÇÄ}{a‚ÇÄ‚Çö ,sp a‚ÇÄ}{A‚ÇÄ~}{a‚ÇÄ~‚Çö ,sp a‚ÇÄ~}{A‚ÇÅ}{a‚ÇÅ‚Çö ,sp a‚ÇÅ}{A‚ÇÅ~}{a‚ÇÅ~‚Çö ,sp a‚ÇÅ~}{A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ‚Çö ,sp a‚ÇÄ‚ÇÅ){B‚ÇÄ}{b‚ÇÄ}{B‚ÇÄ~}{b‚ÇÄ~}{B‚ÇÅ}{b‚ÇÅ}{B‚ÇÅ~}{b‚ÇÅ~}{B‚ÇÄ‚ÇÅ} b‚ÇÄ‚ÇÅ =
  œÄ~‚Çö a‚ÇÄ‚Çö a‚ÇÄ~‚Çö a‚ÇÅ‚Çö a‚ÇÅ~‚Çö a‚ÇÄ‚ÇÅ‚Çö (Œª x ‚Üí proj‚ÇÅsp (b‚ÇÄ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÅsp (b‚ÇÄ~ x‚ÇÄ‚ÇÅ)) (Œª x ‚Üí proj‚ÇÅsp (b‚ÇÅ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÅsp (b‚ÇÅ~ x‚ÇÄ‚ÇÅ)) (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÅsp (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ,sp
  œÄ~‚Çú a‚ÇÄ a‚ÇÄ~ a‚ÇÅ a‚ÇÅ~ a‚ÇÄ‚ÇÅ (Œª x ‚Üí proj‚ÇÇsp (b‚ÇÄ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÇsp (b‚ÇÄ~ x‚ÇÄ‚ÇÅ)) (Œª x ‚Üí proj‚ÇÇsp (b‚ÇÅ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÇsp (b‚ÇÅ~ x‚ÇÄ‚ÇÅ)) (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÇsp (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ))

-- simple eliminator

module _
  {i}
  {j}
  (in-U·¥∞ : ‚àÄ{A : Set} ‚Üí in-U A ‚Üí Prop i)
  (in-U~·¥∞ : {A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí Prop j)
  (bool·¥∞ : in-U·¥∞ bool)
  (œÄ·¥∞ : {A : Set}{a : in-U A}(a·¥∞ : in-U·¥∞ a){A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}(a~·¥∞ : in-U~·¥∞ {a‚ÇÄ = a}{a‚ÇÅ = a} a~)
    {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}(b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
    (b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b x‚ÇÄ}{a‚ÇÅ = b x‚ÇÅ}(b~ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U·¥∞ (œÄ a a~ b b~))
  (bool~·¥∞ : in-U~·¥∞ {a‚ÇÄ = bool}{a‚ÇÅ = bool} bool~)
  (œÄ~·¥∞ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}(a‚ÇÄ~·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÄ} a‚ÇÄ~)
    {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}(a‚ÇÅ~·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÅ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÄ‚ÇÅ)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}(b‚ÇÄ·¥∞ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U·¥∞ (b‚ÇÄ x‚ÇÄ))
      {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÄ x‚ÇÄ}{a‚ÇÅ = b‚ÇÄ x‚ÇÅ} (b‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}(b‚ÇÅ·¥∞ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U·¥∞ (b‚ÇÅ x‚ÇÅ))
      {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÅ x‚ÇÄ}{a‚ÇÅ = b‚ÇÅ x‚ÇÅ} (b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = b‚ÇÄ x‚ÇÄ}{a‚ÇÅ = b‚ÇÅ x‚ÇÅ} (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U~·¥∞ {a‚ÇÄ = œÄ a‚ÇÄ a‚ÇÄ~ b‚ÇÄ b‚ÇÄ~}{a‚ÇÅ = œÄ a‚ÇÅ a‚ÇÅ~ b‚ÇÅ b‚ÇÅ~} (œÄ~ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÄ~ = a‚ÇÄ~}{a‚ÇÅ = a‚ÇÅ}{a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ}{b‚ÇÄ~ = b‚ÇÄ~}{b‚ÇÅ = b‚ÇÅ}{b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ))
  where

  ind-in-U : ‚àÄ{A : Set}(a : in-U A) ‚Üí in-U·¥∞ a
  ind-in-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÄ‚ÇÅ
  ind-in-U (bool‚Çö ,sp _) = bool·¥∞
  ind-in-U (œÄ‚Çö {A} a‚Çö {A~} a~‚Çö {B} b‚Çö {B~} b~‚Çö ,sp œÄ‚Çú a a~ b b~) =
    œÄ·¥∞ (ind-in-U (a‚Çö ,sp a)) (ind-in-U~ (a~‚Çö ,sp a~)) (Œª x ‚Üí ind-in-U (b‚Çö x ,sp b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b~‚Çö x‚ÇÄ‚ÇÅ ,sp b~ x‚ÇÄ‚ÇÅ))
  ind-in-U~ (bool~‚Çö ,sp bool~‚Çú) = bool~·¥∞
  ind-in-U~ (œÄ~‚Çö a‚ÇÄ‚Çö a‚ÇÄ~‚Çö a‚ÇÅ‚Çö a‚ÇÅ~‚Çö a‚ÇÄ‚ÇÅ‚Çö b‚ÇÄ‚Çö b‚ÇÄ~‚Çö b‚ÇÅ‚Çö b‚ÇÅ~‚Çö b‚ÇÄ‚ÇÅ‚Çö ,sp œÄ~‚Çú a‚ÇÄ a‚ÇÄ~ a‚ÇÅ a‚ÇÅ~ a‚ÇÄ‚ÇÅ b‚ÇÄ b‚ÇÄ~ b‚ÇÅ b‚ÇÅ~ b‚ÇÄ‚ÇÅ) =
    œÄ~·¥∞ (ind-in-U (a‚ÇÄ‚Çö ,sp a‚ÇÄ)) (ind-in-U~ (a‚ÇÄ~‚Çö ,sp a‚ÇÄ~)) (ind-in-U (a‚ÇÅ‚Çö ,sp a‚ÇÅ)) (ind-in-U~ (a‚ÇÅ~‚Çö ,sp a‚ÇÅ~)) (ind-in-U~ (a‚ÇÄ‚ÇÅ‚Çö ,sp a‚ÇÄ‚ÇÅ))
    (Œª x ‚Üí ind-in-U (b‚ÇÄ‚Çö x ,sp b‚ÇÄ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b‚ÇÄ~‚Çö x‚ÇÄ‚ÇÅ ,sp b‚ÇÄ~ x‚ÇÄ‚ÇÅ)) (Œª x ‚Üí ind-in-U (b‚ÇÅ‚Çö x ,sp b‚ÇÅ x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b‚ÇÅ~‚Çö x‚ÇÄ‚ÇÅ ,sp b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    Œª x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b‚ÇÄ‚ÇÅ‚Çö x‚ÇÄ‚ÇÅ ,sp b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)


{-
  when the targets go into Set:
  ind-in-U : ‚àÄ{A : Set}(a : in-U A) ‚Üí in-U·¥∞ a
  ind-in-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ {a‚ÇÄ = a‚ÇÄ}{a‚ÇÅ = a‚ÇÅ} a‚ÇÄ‚ÇÅ
  ind-in-U (bool‚Çö ,sp _) = bool·¥∞
  ind-in-U (œÄ‚Çö {A} a‚Çö {A~} a~‚Çö {B} b‚Çö {B~} b~‚Çö ,sp w) = œÄ·¥∞
    {A}{a‚Çö ,sp {!w!}}(ind-in-U (a‚Çö ,sp {!!}))
    {A~}{a~‚Çö ,sp {!!}}(ind-in-U~ (a~‚Çö ,sp {!!}))
    {B}{Œª x ‚Üí (b‚Çö x ,sp {!!})}(Œª x ‚Üí ind-in-U (b‚Çö x ,sp {!!}))
    {B~}{Œª {x‚ÇÄ}{x‚ÇÅ} x‚ÇÄ‚ÇÅ ‚Üí (b~‚Çö x‚ÇÄ‚ÇÅ ,sp {!!})}(Œª {x‚ÇÄ}{x‚ÇÅ} x‚ÇÄ‚ÇÅ ‚Üí ind-in-U~ (b~‚Çö x‚ÇÄ‚ÇÅ ,sp {!!}))
  ind-in-U~ (bool~‚Çö ,sp w) = {!!}
  ind-in-U~ (œÄ~‚Çö a‚ÇÄ proj‚ÇÅsp‚ÇÅ a‚ÇÅ proj‚ÇÅsp‚ÇÇ proj‚ÇÅsp‚ÇÉ b‚ÇÄ b‚ÇÄ~ b‚ÇÅ b‚ÇÅ~ b‚ÇÄ‚ÇÅ ,sp proj‚ÇÇsp‚ÇÅ) = {!!}
-}
