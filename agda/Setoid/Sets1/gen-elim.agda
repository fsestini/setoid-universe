{-# OPTIONS --without-K --prop #-}

module Setoid.Sets1.gen-elim where

open import Setoid.lib
open import Setoid.Sets1.lib hiding (ind-in-U; ind-in-U~)
open import Agda.Builtin.Equality
open import Agda.Primitive

variable i j k l : Level

withProp : ‚àÄ{i j} {P : Prop i} {Q : Prop j} -> P -> (P -> Q) -> Q
withProp p f = f p

postulate
  _‚â°p_ : ‚àÄ{i} {A : Set i} -> A -> A -> Prop i
  reflp : ‚àÄ{i} {A : Set i} {a : A} -> a ‚â°p a
  to-‚â° : ‚àÄ{i} {A : Set i} {x y : A} -> x ‚â°p y -> x ‚â° y

subst-T : {A B : Set i} -> A ‚â° B -> A -> B
subst-T refl x = x

subst : {A : Set i} (C : A -> Set j) {x y : A} -> x ‚â° y -> C x -> C y
subst _ refl x = x

withP : {P : Prop j} {Q : Prop k} {A : Set i} (x y : A)
      ‚Üí P
      ‚Üí (P -> x ‚â°p y)
      ‚Üí (x ‚â° y -> Q)
      ‚Üí Q
withP x y p f g = g (to-‚â° (f p))

module general
  {i}
  {j}
  (in-U·¥∞ : ‚àÄ{A : Set} ‚Üí in-U A ‚Üí Set i)
  (in-U~·¥∞ : {A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop} ‚Üí in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ ‚Üí Prop j)
  (bool·¥∞ : in-U·¥∞ bool)
  (œÄ·¥∞ : {A : Set}{a : in-U A}(a·¥∞ : in-U·¥∞ a){A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}(a~·¥∞ : in-U~·¥∞ a·¥∞ a·¥∞ a~)
    {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}(b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x))
    {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
    {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
    (b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b·¥∞ x‚ÇÄ) (b·¥∞ x‚ÇÅ) (b~ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U·¥∞ (œÄ a a~ b b~))
  (bool~·¥∞ : in-U~·¥∞ bool·¥∞ bool·¥∞ bool~)
  (œÄ~·¥∞ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}(a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ){A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}(a‚ÇÄ~·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ~)
    {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}(a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ){A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}(a‚ÇÅ~·¥∞ : in-U~·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~)
    {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}(a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÄ‚ÇÅ)
    {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}(b‚ÇÄ·¥∞ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U·¥∞ (b‚ÇÄ x‚ÇÄ))
      {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ·¥∞ x‚ÇÄ) (b‚ÇÄ·¥∞ x‚ÇÅ) (b‚ÇÄ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}(b‚ÇÅ·¥∞ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U·¥∞ (b‚ÇÅ x‚ÇÅ))
      {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
      {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
      (b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÅ·¥∞ x‚ÇÄ) (b‚ÇÅ·¥∞ x‚ÇÅ) (b‚ÇÅ~ x‚ÇÄ‚ÇÅ))
    {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
    {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
    (b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ·¥∞ x‚ÇÄ) (b‚ÇÅ·¥∞ x‚ÇÅ) (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)) ‚Üí 
    in-U~·¥∞ (œÄ·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ~·¥∞ b‚ÇÄ·¥∞ b‚ÇÄ~·¥∞) (œÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~·¥∞ b‚ÇÅ·¥∞ b‚ÇÅ~·¥∞) (œÄ~ {a‚ÇÄ = a‚ÇÄ} {a‚ÇÄ~ = a‚ÇÄ~} {a‚ÇÅ = a‚ÇÅ} {a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ} {b‚ÇÄ~ = b‚ÇÄ~} {b‚ÇÅ = b‚ÇÅ} {b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ))
  where

  data R-U : {A : Set} (a : in-U A) -> in-U·¥∞ a -> Prop (lsuc (i ‚äî j))
  data R-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}
              {a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ} {a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ} (a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ)
            ‚Üí in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÄ‚ÇÅ -> Prop (lsuc i ‚äî lsuc j)

  data R-U where
    R-bool : R-U bool bool·¥∞
    R-œÄ :
      {A : Set}{a : in-U A}{a·¥∞ : in-U·¥∞ a}(R-a : R-U a a·¥∞)
      {A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}{a~·¥∞ : in-U~·¥∞ a·¥∞ a·¥∞ a~}(R-a~ : R-U~ a~ a~·¥∞)
      {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}{b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x)}(R-b : (x : A) -> R-U (b x) (b·¥∞ x))
      {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
      {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
      {b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b·¥∞ x‚ÇÄ) (b·¥∞ x‚ÇÅ) (b~ x‚ÇÄ‚ÇÅ)}
      (R-B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~ (b~ x‚ÇÄ‚ÇÅ) (b~·¥∞ x‚ÇÄ‚ÇÅ))
      ‚Üí R-U (œÄ a a~ b b~) (œÄ·¥∞ a·¥∞ a~·¥∞ b·¥∞ b~·¥∞)

  data R-U~ where
    R-bool~ : R-U~ bool~ bool~·¥∞
    R-œÄ~ : {A‚ÇÄ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ}(R-a‚ÇÄ : R-U a‚ÇÄ a‚ÇÄ·¥∞)
           {A‚ÇÄ~ : A‚ÇÄ ‚Üí A‚ÇÄ ‚Üí Prop}{a‚ÇÄ~ : in-U~ a‚ÇÄ a‚ÇÄ A‚ÇÄ~}{a‚ÇÄ~·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ~}(R-a‚ÇÄ~ : R-U~ a‚ÇÄ~ a‚ÇÄ~·¥∞)
           {A‚ÇÅ : Set}{a‚ÇÅ : in-U A‚ÇÅ}{a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ}(R-a‚ÇÅ : R-U a‚ÇÅ a‚ÇÅ·¥∞)
           {A‚ÇÅ~ : A‚ÇÅ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÅ~ : in-U~ a‚ÇÅ a‚ÇÅ A‚ÇÅ~}{a‚ÇÅ~·¥∞ : in-U~·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~}(R-a‚ÇÅ~ : R-U~ a‚ÇÅ~ a‚ÇÅ~·¥∞)
           {A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}{a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÄ‚ÇÅ}(R-a‚ÇÄ‚ÇÅ : R-U~ a‚ÇÄ‚ÇÅ a‚ÇÄ‚ÇÅ·¥∞)
           {B‚ÇÄ : A‚ÇÄ ‚Üí Set}{b‚ÇÄ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U (B‚ÇÄ x‚ÇÄ)}{b‚ÇÄ·¥∞ : (x‚ÇÄ : A‚ÇÄ) ‚Üí in-U·¥∞ (b‚ÇÄ x‚ÇÄ)}(R-b‚ÇÄ : (x : _) -> R-U (b‚ÇÄ x) (b‚ÇÄ·¥∞ x))

           {B‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÄ x‚ÇÅ ‚Üí Prop}
           {b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÄ x‚ÇÅ) (B‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
           {b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ·¥∞ x‚ÇÄ) (b‚ÇÄ·¥∞ x‚ÇÅ) (b‚ÇÄ~ x‚ÇÄ‚ÇÅ)}
           (R-b‚ÇÄ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~ (b‚ÇÄ~ x‚ÇÄ‚ÇÅ) (b‚ÇÄ~·¥∞ x‚ÇÄ‚ÇÅ))
           
           {B‚ÇÅ : A‚ÇÅ ‚Üí Set}{b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U (B‚ÇÅ x‚ÇÅ)}{b‚ÇÅ·¥∞ : (x‚ÇÅ : A‚ÇÅ) ‚Üí in-U·¥∞ (b‚ÇÅ x‚ÇÅ)}(R-b‚ÇÅ : (x‚ÇÅ : A‚ÇÅ) ‚Üí R-U (b‚ÇÅ x‚ÇÅ) (b‚ÇÅ·¥∞ x‚ÇÅ))

           {B‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÅ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
           {b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÅ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
           {b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÅ·¥∞ x‚ÇÄ) (b‚ÇÅ·¥∞ x‚ÇÅ) (b‚ÇÅ~ x‚ÇÄ‚ÇÅ)}
           (R-b‚ÇÅ~ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~ (b‚ÇÅ~ x‚ÇÄ‚ÇÅ) (b‚ÇÅ~·¥∞ x‚ÇÄ‚ÇÅ))
           
           {B‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí B‚ÇÄ x‚ÇÄ ‚Üí B‚ÇÅ x‚ÇÅ ‚Üí Prop}
           {b‚ÇÄ‚ÇÅ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b‚ÇÄ x‚ÇÄ) (b‚ÇÅ x‚ÇÅ) (B‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
           {b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b‚ÇÄ·¥∞ x‚ÇÄ) (b‚ÇÅ·¥∞ x‚ÇÅ) (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ)}
           (R-b‚ÇÄ‚ÇÅ·¥∞ : {x‚ÇÄ : A‚ÇÄ}{x‚ÇÅ : A‚ÇÅ}(x‚ÇÄ‚ÇÅ : A‚ÇÄ‚ÇÅ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~ (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ) (b‚ÇÄ‚ÇÅ·¥∞ x‚ÇÄ‚ÇÅ))
        ‚Üí R-U~
            (œÄ~ {a‚ÇÄ = a‚ÇÄ} {a‚ÇÄ~ = a‚ÇÄ~} {a‚ÇÅ = a‚ÇÅ} {a‚ÇÅ~ = a‚ÇÅ~} a‚ÇÄ‚ÇÅ {b‚ÇÄ = b‚ÇÄ} {b‚ÇÄ~ = b‚ÇÄ~} {b‚ÇÅ = b‚ÇÅ} {b‚ÇÅ~ = b‚ÇÅ~} b‚ÇÄ‚ÇÅ)
            (œÄ~·¥∞ a‚ÇÄ·¥∞ a‚ÇÄ~·¥∞ a‚ÇÅ·¥∞ a‚ÇÅ~·¥∞ a‚ÇÄ‚ÇÅ·¥∞ b‚ÇÄ·¥∞ b‚ÇÄ~·¥∞ b‚ÇÅ·¥∞ b‚ÇÅ~·¥∞ b‚ÇÄ‚ÇÅ·¥∞)

  module Elim-R-U
    {‚Ñì     : Level}
    {‚Ñì~    : Level}
    (R-U'  : {A : Set} (a : in-U A)(a·¥∞ : in-U·¥∞ a) -> R-U a a·¥∞ ‚Üí Prop ‚Ñì)
    (R-U~' : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}
              {a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ} {a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ} (a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ)
            ‚Üí (a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÄ‚ÇÅ) -> R-U~ a‚ÇÄ‚ÇÅ a‚ÇÄ‚ÇÅ·¥∞  ‚Üí Prop ‚Ñì~)
    (R-bool' : R-U' bool bool·¥∞ R-bool)
    (R-œÄ' :
      {A : Set}{a : in-U A}{a·¥∞ : in-U·¥∞ a}{R-a : R-U a a·¥∞}(R-a' : R-U' a a·¥∞ R-a)
      {A~ : A ‚Üí A ‚Üí Prop}{a~ : in-U~ a a A~}{a~·¥∞ : in-U~·¥∞ a·¥∞ a·¥∞ a~}
      {R-a~ : R-U~ a~ a~·¥∞}(R-a~' : R-U~' a~ a~·¥∞ R-a~)
      {B : A ‚Üí Set}{b : (x : A) ‚Üí in-U (B x)}{b·¥∞ : (x : A) ‚Üí in-U·¥∞ (b x)}
      {R-b : (x : A) -> R-U (b x) (b·¥∞ x)}(R-b' : (x : A) -> R-U' (b x) (b·¥∞ x) (R-b x))
      {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
      {b~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~ (b x‚ÇÄ) (b x‚ÇÅ) (B~ x‚ÇÄ‚ÇÅ)}
      {b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~·¥∞ (b·¥∞ x‚ÇÄ) (b·¥∞ x‚ÇÅ) (b~ x‚ÇÄ‚ÇÅ)}
      {R-B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~ (b~ x‚ÇÄ‚ÇÅ) (b~·¥∞ x‚ÇÄ‚ÇÅ)}
      (R-B~' : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~' (b~ x‚ÇÄ‚ÇÅ) (b~·¥∞ x‚ÇÄ‚ÇÅ) (R-B~ x‚ÇÄ‚ÇÅ))
      ‚Üí R-U' (œÄ a a~ b b~) (œÄ·¥∞ a·¥∞ a~·¥∞ b·¥∞ b~·¥∞) (R-œÄ R-a R-a~ R-b R-B~))
     where

    postulate
      elim-R-U~ :
        ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}
        {a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ} {a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ}{a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ}{a‚ÇÄ‚ÇÅ·¥∞ : in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÅ·¥∞ a‚ÇÄ‚ÇÅ}
        (R-a~ : R-U~ a‚ÇÄ‚ÇÅ a‚ÇÄ‚ÇÅ·¥∞) ‚Üí R-U~' a‚ÇÄ‚ÇÅ a‚ÇÄ‚ÇÅ·¥∞ R-a~

    elim-R-U : {A : Set}{a : in-U A}{a·¥∞ : in-U·¥∞ a}(R-a : R-U a a·¥∞) ‚Üí R-U' a a·¥∞ R-a
    elim-R-U R-bool = R-bool'
    elim-R-U (R-œÄ R-a R-a~ R-b R-B~) = R-œÄ' (elim-R-U R-a) (elim-R-U~ R-a~) (Œª x ‚Üí elim-R-U (R-b x)) (Œª x‚ÇÄ‚ÇÅ ‚Üí elim-R-U~ (R-B~ x‚ÇÄ‚ÇÅ))


  invert-bool : {x·¥∞ : in-U·¥∞ bool} ‚Üí R-U bool x·¥∞ ‚Üí bool·¥∞ ‚â°p x·¥∞
  invert-bool R-bool = reflp

  module warmup where
    data T : Set ‚Üí Set‚ÇÅ where
      c1 : ùüö ‚Üí T (ùüö ‚Üí ùüö)
      c2 : T ùüö

    elim :
      (T' : (A : Set) ‚Üí T A ‚Üí Set‚ÇÅ)
      (c1' : (x : ùüö) ‚Üí T' (ùüö ‚Üí ùüö) (c1 x))
      (c2' : T' ùüö c2)
      {A : Set}(t : T A) ‚Üí T' A t
    elim T' c1' c2' (c1 x) = c1' x
    elim T' c1' c2' c2 = c2'

    rec : (T' : Set ‚Üí Set)(c1' : ùüö ‚Üí T' (ùüö ‚Üí ùüö))(c2' : T' ùüö){A : Set} ‚Üí T A ‚Üí T' A
    rec T' c1' c2' (c1 x) = c1' x
    rec T' c1' c2' c2 = c2'

    -- invert' : (t : T (ùüö ‚Üí ùüö)) ‚Üí Œ£ ((ùüö ‚Üí ùüö) ‚â° (ùüö ‚Üí ùüö)) (Œª e ‚Üí Œ£ ùüö (Œª x ‚Üí subst T e t ‚â° c1 x))
    -- invert' t =  elim (Œª A t ‚Üí Œ£ (A ‚â° (ùüö ‚Üí ùüö)) Œª e ‚Üí Œ£ ùüö Œª x ‚Üí subst T e t ‚â° c1 x) (Œª x ‚Üí refl ,Œ£ (x ,Œ£ refl)) {!!} t 
    invert' : (t : T (ùüö ‚Üí ùüö)) ‚Üí Œ£ ùüö Œª x ‚Üí t ‚â° c1 x
    invert' t = elim (Œª A t ‚Üí (e : A ‚â° (ùüö ‚Üí ùüö)) ‚Üí Œ£ ùüö Œª x ‚Üí subst T e t ‚â° c1 x) (Œª { x e' ‚Üí x ,Œ£ {!!} }) (Œª e ‚Üí {!!}) t refl
    -- Ambrus believes that with K we can prove invert'
    -- rec (Œª _ ‚Üí ùüö) (Œª x ‚Üí x) {! ùüö ‚â° (ùüö ‚Üí ùüö)!} t

  invert : ‚àÄ{i} {P : Prop i} {A : Set}{a‚Çö : in-U‚Çö A}{A~ : A ‚Üí A ‚Üí Prop}{a~‚Çö : in-U~‚Çö A~}
        {B : A ‚Üí Set}{b‚Çö : (x : A) ‚Üí in-U‚Çö (B x)}
        {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
        {b~‚Çö : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B~ x‚ÇÄ‚ÇÅ)}
        {a‚Çú : _} {a~‚Çú : _} {b‚Çú : _} {b~‚Çú : {x‚ÇÄ x‚ÇÅ : A} (x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí _}
        {x·¥∞ : in-U·¥∞ (œÄ {A}(a‚Çö ,sp a‚Çú){A~}(a~‚Çö ,sp a~‚Çú){B} (Œª x ‚Üí b‚Çö x ,sp b‚Çú x) {B~} (Œª x‚ÇÄ‚ÇÅ ‚Üí b~‚Çö x‚ÇÄ‚ÇÅ ,sp b~‚Çú x‚ÇÄ‚ÇÅ))}
      ‚Üí R-U {Œ£sp _ _}(œÄ‚Çö a‚Çö a~‚Çö b‚Çö b~‚Çö ,sp œÄ‚Çú a‚Çú a~‚Çú b‚Çú Œª x‚ÇÄ‚ÇÅ ‚Üí b~‚Çú x‚ÇÄ‚ÇÅ) x·¥∞
      ‚Üí Œ£ _ Œª a·¥∞ ‚Üí
        Œ£ps _ Œª a~·¥∞ ‚Üí
        Œ£ ((x : _) ‚Üí _) Œª b·¥∞ ‚Üí
        Œ£ps ({x‚ÇÄ x‚ÇÅ : A} (x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí _) Œª b~·¥∞ ‚Üí
          (œÄ·¥∞ {a = a‚Çö ,sp a‚Çú} a·¥∞ {a~ = a~‚Çö ,sp a~‚Çú} a~·¥∞ {b = Œª x ‚Üí b‚Çö x ,sp b‚Çú x} b·¥∞ {b~ = Œª x‚ÇÄ‚ÇÅ ‚Üí b~‚Çö x‚ÇÄ‚ÇÅ ,sp b~‚Çú x‚ÇÄ‚ÇÅ} b~·¥∞ ‚â° x·¥∞)
  invert r = {!Elim-R-U.elim-R-U (Œª {A} a a·¥∞ R-a ‚Üí A ‚â° Œ£sp _ _ ‚Üí a ‚â° (œÄ‚Çö a‚Çö a~‚Çö b‚Çö b~‚Çö ,sp œÄ‚Çú a‚Çú a~‚Çú b‚Çú Œª x‚ÇÄ‚ÇÅ ‚Üí b~‚Çú x‚ÇÄ‚ÇÅ)
              ‚Üí Œ£ ...  (subst ... R-a ‚â° R-œÄ ...)!}

{-
  invert : ‚àÄ{i} {P : Prop i} {A : Set}{a‚Çö : in-U‚Çö A}{A~ : A ‚Üí A ‚Üí Prop}{a~‚Çö : in-U~‚Çö A~}
        {B : A ‚Üí Set}{b‚Çö : (x : A) ‚Üí in-U‚Çö (B x)}
        {B~ : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí B x‚ÇÄ ‚Üí B x‚ÇÅ ‚Üí Prop}
        {b~‚Çö : {x‚ÇÄ x‚ÇÅ : A}(x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí in-U~‚Çö (B~ x‚ÇÄ‚ÇÅ)}
        {a‚Çú : _} {a~‚Çú : _} {b‚Çú : _} {b~‚Çú : {x‚ÇÄ x‚ÇÅ : A} (x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí _}
        {x·¥∞ : in-U·¥∞ (œÄ {A}(a‚Çö ,sp a‚Çú){A~}(a~‚Çö ,sp a~‚Çú){B} (Œª x ‚Üí b‚Çö x ,sp b‚Çú x) {B~} (Œª x‚ÇÄ‚ÇÅ ‚Üí b~‚Çö x‚ÇÄ‚ÇÅ ,sp b~‚Çú x‚ÇÄ‚ÇÅ))}
      ‚Üí R-U {Œ£sp _ _}(œÄ‚Çö a‚Çö a~‚Çö b‚Çö b~‚Çö ,sp œÄ‚Çú a‚Çú a~‚Çú b‚Çú Œª x‚ÇÄ‚ÇÅ ‚Üí b~‚Çú x‚ÇÄ‚ÇÅ) x·¥∞
      ‚Üí ({a·¥∞ : _} {a~·¥∞ : _} {b·¥∞ : (x : _) -> _} {b~·¥∞ : {x‚ÇÄ x‚ÇÅ : A} (x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí _}
          -> R-U (a‚Çö ,sp a‚Çú) a·¥∞
          -> R-U~ (a~‚Çö ,sp a~‚Çú) a~·¥∞
          -> ((x : _) -> R-U (b‚Çö x ,sp b‚Çú x) (b·¥∞ x))
          -> ({x‚ÇÄ x‚ÇÅ : A} (x‚ÇÄ‚ÇÅ : A~ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~ (b~‚Çö x‚ÇÄ‚ÇÅ ,sp b~‚Çú x‚ÇÄ‚ÇÅ) (b~·¥∞ x‚ÇÄ‚ÇÅ))
          -> œÄ·¥∞ {a = a‚Çö ,sp a‚Çú} a·¥∞ {a~ = a~‚Çö ,sp a~‚Çú} a~·¥∞
                {b = Œª x ‚Üí b‚Çö x ,sp b‚Çú x} b·¥∞ {b~ = Œª x‚ÇÄ‚ÇÅ ‚Üí b~‚Çö x‚ÇÄ‚ÇÅ ,sp b~‚Çú x‚ÇÄ‚ÇÅ} b~·¥∞ ‚â° x·¥∞
          -> P)
      ‚Üí P
  invert r = {!r!}
-}

{-
  exists-U : {A : Set} (a‚Çö : in-U‚Çö A) (a‚Çú : in-U‚Çú a‚Çö) -> Œ£sp (in-U·¥∞ (a‚Çö ,sp a‚Çú)) (R-U (a‚Çö ,sp a‚Çú))
  exists-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}
              {a‚ÇÄ·¥∞ : in-U·¥∞ a‚ÇÄ} {a‚ÇÅ·¥∞ : in-U·¥∞ a‚ÇÅ} (p‚ÇÄ : R-U a‚ÇÄ a‚ÇÄ·¥∞) (p‚ÇÅ : R-U a‚ÇÅ a‚ÇÅ·¥∞)
              (a‚ÇÄ‚ÇÅ‚Çö : in-U~‚Çö A‚ÇÄ‚ÇÅ) (a‚ÇÄ‚ÇÅ‚Çú : in-U~‚Çú (proj‚ÇÅsp a‚ÇÄ) (proj‚ÇÅsp a‚ÇÅ) a‚ÇÄ‚ÇÅ‚Çö)
            ‚Üí Œ£p (in-U~·¥∞ a‚ÇÄ·¥∞ a‚ÇÅ·¥∞ (a‚ÇÄ‚ÇÅ‚Çö ,sp a‚ÇÄ‚ÇÅ‚Çú)) (R-U~ (a‚ÇÄ‚ÇÅ‚Çö ,sp a‚ÇÄ‚ÇÅ‚Çú))

  exists-U bool‚Çö a‚Çú = _ ,sp R-bool
  exists-U (œÄ‚Çö a‚Çö a~‚Çö b‚Çö b~‚Çö) p = _ ,sp
    R-œÄ ih-a (proj‚ÇÇp (exists-U~ ih-a ih-a a~‚Çö a~‚Çú)) ih-b
        (Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÇp (exists-U~ (ih-b _) (ih-b _) (b~‚Çö x‚ÇÄ‚ÇÅ) (b~‚Çú x‚ÇÄ‚ÇÅ)))
    where
      a‚Çú : in-U‚Çú a‚Çö
      a‚Çú = withProp p Œª { (œÄ‚Çú x _ _ _) ‚Üí x }
      a~‚Çú : in-U~‚Çú a‚Çö a‚Çö a~‚Çö
      a~‚Çú = withProp p Œª { (œÄ‚Çú _ x _ _) ‚Üí x }
      ih-a = proj‚ÇÇsp (exists-U a‚Çö a‚Çú)
      b‚Çú : (x : _) -> in-U‚Çú (b‚Çö x)
      b‚Çú x = withProp p Œª { (œÄ‚Çú _ _ f _) ‚Üí f x }
      ih-b : (x : _) -> _
      ih-b x = proj‚ÇÇsp (exists-U (b‚Çö x) (b‚Çú x))
      b~‚Çú : {x‚ÇÄ x‚ÇÅ : _} (x‚ÇÄ‚ÇÅ : _) -> in-U~‚Çú (b‚Çö x‚ÇÄ) (b‚Çö x‚ÇÅ) (b~‚Çö x‚ÇÄ‚ÇÅ)
      b~‚Çú xx = withProp p Œª { (œÄ‚Çú _ _ _ f) ‚Üí f xx }

  exists-U~ {a‚ÇÄ = a‚ÇÄ} {a‚ÇÅ} {a‚ÇÄ·¥∞ = a‚ÇÄ·¥∞} {a‚ÇÅ·¥∞} p‚ÇÄ p‚ÇÅ bool~‚Çö y =
    goal (to-‚â° (withProp y (Œª { bool~‚Çú ‚Üí reflp }))) (to-‚â° (withProp y (Œª { bool~‚Çú ‚Üí reflp })))
    where
      goal : bool‚Çö ‚â° proj‚ÇÅsp a‚ÇÄ -> bool‚Çö ‚â° proj‚ÇÅsp a‚ÇÅ -> _
      goal refl refl =
        goal' (to-‚â° (withProp p‚ÇÄ (Œª { R-bool ‚Üí reflp})))
              (to-‚â° (withProp p‚ÇÅ (Œª { R-bool ‚Üí reflp})))
        where
          goal' : bool·¥∞ ‚â° a‚ÇÄ·¥∞ -> bool·¥∞ ‚â° a‚ÇÅ·¥∞ -> _
          goal' refl refl = bool~·¥∞ ,p R-bool~

  exists-U~ {a‚ÇÄ·¥∞ = x·¥∞} {y·¥∞} p‚ÇÄ p‚ÇÅ
    (œÄ~‚Çö {A‚ÇÄ = A‚ÇÄ} a‚ÇÄ {A‚ÇÄ~ = A‚ÇÄ~} a‚ÇÄ~ {A‚ÇÅ = A‚ÇÅ} a‚ÇÅ {A‚ÇÅ~ = A‚ÇÅ~} a‚ÇÅ~ a‚ÇÄ‚ÇÅ b‚ÇÄ b‚ÇÄ~ b‚ÇÅ b‚ÇÅ~ b‚ÇÄ‚ÇÅ)
    (œÄ~‚Çú a‚ÇÄ‚Çú a‚ÇÄ~‚Çú a‚ÇÅ‚Çú a‚ÇÅ~‚Çú a‚ÇÄ‚ÇÅ‚Çú b‚ÇÄ‚Çú b‚ÇÄ~‚Çú b‚ÇÅ‚Çú b‚ÇÅ~‚Çú b‚ÇÄ‚ÇÅ‚Çú) =
    invert p‚ÇÄ Œª x x‚ÇÅ x‚ÇÇ x‚ÇÉ x‚ÇÑ ‚Üí invert p‚ÇÅ Œª x‚ÇÖ x‚ÇÜ x‚Çá x‚Çà x‚Çâ ‚Üí
      aux x x‚ÇÅ x‚ÇÇ x‚ÇÉ x‚ÇÑ x‚ÇÖ x‚ÇÜ x‚Çá x‚Çà x‚Çâ
    where
      aux : {a‚ÇÄ·¥∞ : _} {a‚ÇÄ~·¥∞ : _} {b‚ÇÄ·¥∞ : (x : _) -> _} {b‚ÇÄ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÄ} (x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí _}
         -> R-U (a‚ÇÄ ,sp a‚ÇÄ‚Çú) a‚ÇÄ·¥∞
         -> R-U~ (a‚ÇÄ~ ,sp a‚ÇÄ~‚Çú) a‚ÇÄ~·¥∞
         -> ((x : _) -> R-U (b‚ÇÄ x ,sp b‚ÇÄ‚Çú x) (b‚ÇÄ·¥∞ x))
         -> ({x‚ÇÄ x‚ÇÅ : A‚ÇÄ} (x‚ÇÄ‚ÇÅ : A‚ÇÄ~ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~ (b‚ÇÄ~ x‚ÇÄ‚ÇÅ ,sp b‚ÇÄ~‚Çú x‚ÇÄ‚ÇÅ) (b‚ÇÄ~·¥∞ x‚ÇÄ‚ÇÅ))
         -> œÄ·¥∞ {a = a‚ÇÄ ,sp _} a‚ÇÄ·¥∞ {a~ = a‚ÇÄ~ ,sp _} a‚ÇÄ~·¥∞ {b = _} b‚ÇÄ·¥∞ {b~ = Œª x‚ÇÄ‚ÇÅ ‚Üí b‚ÇÄ~ x‚ÇÄ‚ÇÅ ,sp b‚ÇÄ~‚Çú x‚ÇÄ‚ÇÅ} b‚ÇÄ~·¥∞ ‚â° x·¥∞

         -> {a‚ÇÅ·¥∞ : _} {a‚ÇÅ~·¥∞ : _} {b‚ÇÅ·¥∞ : (x : _) -> _} {b‚ÇÅ~·¥∞ : {x‚ÇÄ x‚ÇÅ : A‚ÇÅ} (x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí _}
         -> R-U (a‚ÇÅ ,sp a‚ÇÅ‚Çú) a‚ÇÅ·¥∞
         -> R-U~ (a‚ÇÅ~ ,sp a‚ÇÅ~‚Çú) a‚ÇÅ~·¥∞
         -> ((x : _) -> R-U (b‚ÇÅ x ,sp b‚ÇÅ‚Çú x) (b‚ÇÅ·¥∞ x))
         -> ({x‚ÇÄ x‚ÇÅ : A‚ÇÅ} (x‚ÇÄ‚ÇÅ : A‚ÇÅ~ x‚ÇÄ x‚ÇÅ) ‚Üí R-U~ (b‚ÇÅ~ x‚ÇÄ‚ÇÅ ,sp b‚ÇÅ~‚Çú x‚ÇÄ‚ÇÅ) (b‚ÇÅ~·¥∞ x‚ÇÄ‚ÇÅ))
         -> œÄ·¥∞ {a = a‚ÇÅ ,sp _} a‚ÇÅ·¥∞ {a~ = a‚ÇÅ~ ,sp _} a‚ÇÅ~·¥∞ {b = _} b‚ÇÅ·¥∞ {b~ = Œª x‚ÇÄ‚ÇÅ ‚Üí b‚ÇÅ~ x‚ÇÄ‚ÇÅ ,sp b‚ÇÅ~‚Çú x‚ÇÄ‚ÇÅ} b‚ÇÅ~·¥∞ ‚â° y·¥∞

         -> Œ£p (in-U~·¥∞ x·¥∞ y·¥∞ (œÄ~‚Çö a‚ÇÄ a‚ÇÄ~ a‚ÇÅ a‚ÇÅ~ a‚ÇÄ‚ÇÅ b‚ÇÄ b‚ÇÄ~ b‚ÇÅ b‚ÇÅ~ b‚ÇÄ‚ÇÅ ,sp
                                  œÄ~‚Çú a‚ÇÄ‚Çú a‚ÇÄ~‚Çú a‚ÇÅ‚Çú a‚ÇÅ~‚Çú a‚ÇÄ‚ÇÅ‚Çú b‚ÇÄ‚Çú b‚ÇÄ~‚Çú b‚ÇÅ‚Çú b‚ÇÅ~‚Çú b‚ÇÄ‚ÇÅ‚Çú))
               (R-U~ (œÄ~‚Çö a‚ÇÄ a‚ÇÄ~ a‚ÇÅ a‚ÇÅ~ a‚ÇÄ‚ÇÅ b‚ÇÄ b‚ÇÄ~ b‚ÇÅ b‚ÇÅ~ b‚ÇÄ‚ÇÅ ,sp _))
      aux x x‚ÇÅ x‚ÇÇ x‚ÇÉ refl x‚ÇÑ x‚ÇÖ x‚ÇÜ x‚Çá refl =
        _ ,p R-œÄ~ x x‚ÇÅ x‚ÇÑ x‚ÇÖ (proj‚ÇÇp ih) x‚ÇÇ x‚ÇÉ x‚ÇÜ x‚Çá Œª x‚ÇÄ‚ÇÅ ‚Üí proj‚ÇÇp (ih' x‚ÇÄ‚ÇÅ)
        where
          ih = exists-U~ x x‚ÇÑ a‚ÇÄ‚ÇÅ a‚ÇÄ‚ÇÅ‚Çú
          ih' : {x‚ÇÄ : A‚ÇÄ} {x‚ÇÅ : A‚ÇÅ} (x‚ÇÄ‚ÇÅ : _) ‚Üí _
          ih' {x‚ÇÄ} {x‚ÇÅ} x‚ÇÄ‚ÇÅ = exists-U~ (x‚ÇÇ x‚ÇÄ) (x‚ÇÜ x‚ÇÅ) (b‚ÇÄ‚ÇÅ x‚ÇÄ‚ÇÅ) (b‚ÇÄ‚ÇÅ‚Çú x‚ÇÄ‚ÇÅ)

  ind-in-U : ‚àÄ{A : Set}(a : in-U A) ‚Üí in-U·¥∞ a
  ind-in-U (a‚Çö ,sp a‚Çú) = proj‚ÇÅsp (exists-U a‚Çö a‚Çú)
  
  ind-in-U~ : ‚àÄ{A‚ÇÄ A‚ÇÅ : Set}{a‚ÇÄ : in-U A‚ÇÄ}{a‚ÇÅ : in-U A‚ÇÅ}{A‚ÇÄ‚ÇÅ : A‚ÇÄ ‚Üí A‚ÇÅ ‚Üí Prop}(a‚ÇÄ‚ÇÅ : in-U~ a‚ÇÄ a‚ÇÅ A‚ÇÄ‚ÇÅ) ‚Üí in-U~·¥∞ (ind-in-U a‚ÇÄ) (ind-in-U a‚ÇÅ) a‚ÇÄ‚ÇÅ
  ind-in-U~ (a‚ÇÄ‚ÇÅ‚Çö ,sp a‚ÇÄ‚ÇÅ‚Çú) = proj‚ÇÅp (exists-U~ (proj‚ÇÇsp (exists-U _ _)) (proj‚ÇÇsp (exists-U _ _)) a‚ÇÄ‚ÇÅ‚Çö a‚ÇÄ‚ÇÅ‚Çú)
-}
